{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Bienvenue sur mon Portfolio","text":""},{"location":"#presentation","title":"Pr\u00e9sentation :","text":"<p>Je suis un \u00e9l\u00e8ve en BTS Syst\u00e8me Informatique aux organisations. J'ai pris l'option Solutions d'infrastructure, syst\u00e8mes et r\u00e9seaux.</p> <p>Sur ce Portfolio vous aurez acc\u00e8s \u00e0 :</p> <ul> <li> <p>Mes diff\u00e9rentes missions d'AP dans l'onglet AP </p> </li> <li> <p>Une pr\u00e9sentation bri\u00e8ve de mon bts dans l'onglet BTS SIO</p> </li> <li> <p>Mon CV dans l'onglet CV</p> </li> <li> <p>Ma fiche contact dans l'onglet contact </p> </li> <li> <p>Mon tableau de synth\u00e8se de comp\u00e9tences dans l'onglet epreuve E4</p> </li> <li> <p>Mes 2 pr\u00e9sentations de situations pour l'\u00e9preuve E5 dans l'onglet epreuve E5</p> </li> <li> <p>Mon stage de 2\u00e8me ann\u00e9e dans l'onglet Stage 2024 CD72</p> </li> <li> <p>Mon stage de 1\u00e8re ann\u00e9e dans l'onglet Stage 2023 CD72 </p> </li> <li> <p>Ma veille techno dans l'onglet Veille Techno</p> </li> </ul>"},{"location":"AP/AP%203/AP3/","title":"Mission agencement de Windows","text":""},{"location":"AP/AP%203/AP3/#presentation-de-lorganisation","title":"Pr\u00e9sentation de l'organisation","text":"<p> La soci\u00e9t\u00e9 M2L g\u00e8re les clubs sportifs et fournit toute la logistique informatique n\u00e9cessaire aux diff\u00e9rentes ligues.</p> <p>L\u2019organisation du syst\u00e8me informatique est constitu\u00e9e du si\u00e8ge \u00e0 BLOIS et de diff\u00e9rentes agences r\u00e9parties abritant les diff\u00e9rentes ligues. </p> <p>La soci\u00e9t\u00e9 M2L installe en fonction de l\u2019agence, le syst\u00e8me informatique de base qui est constitu\u00e9 en g\u00e9n\u00e9ral des \u00e9l\u00e9ments suivants :</p> <ul> <li> <p>Des postes client de l\u2019agence (30 \u00e0 100 postes). Fonctionnement sous linux </p> </li> <li> <p>Poste Administrateur </p> </li> <li> <p>Serveur WEB en DMZ qui h\u00e9berge les informations de la ligue locale qui n\u2019est pas implant\u00e9 </p> </li> <li> <p>Serveur Proxy qui filtre et journalise les acc\u00e8s </p> </li> <li> <p>Tous les serveurs sont accessibles en SSH depuis le LAN </p> </li> <li> <p>un pare feu sous pfsense pour le filrage p\u00e9rim\u00e9trique LAN INTERNET DMZ </p> </li> </ul> <p>Un VPN relie les agences aux si\u00e8ges.</p> <p>Le si\u00e8ge fournit les services suivants aux agences :</p> <pre><code>- Gestion du parc et des tickets avec GLPI\n\n- Supervision avec Centreon\n\nGestion centralis\u00e9 des logs avec GRAYlog\n\nGestion de la sauvegarde \u2013 OpenMediaVault\n</code></pre> <ul> <li>Le si\u00e8ge lui-m\u00eame est compos\u00e9 de poste de travail sous Windows 10 , de deux contr\u00f4leurs de domaine \u2013 M2L.loc -et d\u2019un serveur de fichiers qui stocke les dossier utilisateurs et des groupes de travail du si\u00e8ge.</li> </ul>"},{"location":"AP/AP%203/AP3/#schema-du-si","title":"Sch\u00e9ma du SI","text":""},{"location":"AP/AP%203/AP3/#presentation-du-groupe-et-le-travaille-en-mode-projet","title":"Pr\u00e9sentation du groupe et le travaille en mode projet  :","text":"<p>Pour cette situation, on \u00e9tait 3, on s'est r\u00e9parti les t\u00e2ches en fonction des serveurs. Personnellement j\u2019ai travaill\u00e9 principalement sur l\u2019AD1 et l\u2019AD2. Pour s\u2019organiser on a utilis\u00e9 l\u2019outil Trello pour se r\u00e9partir les t\u00e2ches. Apr\u00e8s chaque t\u00e2che, nous avons r\u00e9alis\u00e9 une doc et suite \u00e0 cela ont proc\u00e9d\u00e9 \u00e0 une \u00e9tape de validation pour valider les t\u00e2ches.</p>"},{"location":"AP/AP%203/AP3/#objectif","title":"Objectif :","text":"<p>Sur le si\u00e8ge niveau suret\u00e9 et s\u00e9curit\u00e9 il n\u2019y avait aucun moyen mis en place pour cela. C\u2019est pour cela qu\u2019on nous a demand\u00e9 d\u2019installer un deuxi\u00e8me AD pour r\u00e9pondre aux tol\u00e9rances aux pannes. Ensuite on devait r\u00e9organiser l\u2019AD1 en cr\u00e9ant des OU, des GPO.</p>"},{"location":"AP/AP%203/AP3/#presentation-de-la-situation","title":"Pr\u00e9sentation de la situation","text":""},{"location":"AP/AP%203/AP3/#organisation","title":"Organisation","text":"<ul> <li>J'ai consult\u00e9 des fiches PDF fournies par mon professeur et effectu\u00e9 des recherches sur des sujets tels que les navigateurs internet et les intelligences artificielles comme ChatGPT. </li> </ul>"},{"location":"AP/AP%203/AP3/#creation-des-nouveaux-ou-unites-dorganisation","title":"Cr\u00e9ation des nouveaux OU (Unit\u00e9s d'Organisation) :","text":"<ul> <li> <p>J'ai cr\u00e9\u00e9 des unit\u00e9s d'organisation pour regrouper diff\u00e9rents types d'utilisateurs tels que Admin, Internes, Externe et Invit\u00e9s. </p> </li> <li> <p>J'ai \u00e9galement cr\u00e9\u00e9 des groupes tels que Rugby, Foot, \u00c9quitation et Basket dans ces unit\u00e9s. </p> </li> <li> <p>Dans ces OU j\u2019ai pu int\u00e9grer mes utilisateurs  </p> </li> </ul>"},{"location":"AP/AP%203/AP3/#ajout-des-differents-roles","title":"Ajout des diff\u00e9rents r\u00f4les :","text":"<ul> <li>Mon serveur AD a des r\u00f4les tels que DHCP et DNS. </li> </ul>"},{"location":"AP/AP%203/AP3/#la-plage-dhcp","title":"La plage dhcp :","text":"<p>192.168.10.34 \u00e0 192.168.10.40 </p>"},{"location":"AP/AP%203/AP3/#les-dns","title":"Les dns :","text":"<p>192.168.10.17 et 192.168.10.19 </p>"},{"location":"AP/AP%203/AP3/#creation-de-gpo-objets-de-strategie-de-groupe","title":"Cr\u00e9ation de GPO (Objets de Strat\u00e9gie de Groupe):","text":"<ul> <li>J'ai mis en place des GPO pour g\u00e9rer les crit\u00e8res de mots de passe et cr\u00e9er des lecteurs r\u00e9seau pour les utilisateurs et les groupes </li> </ul>"},{"location":"AP/AP%203/AP3/#installation-du-serveur-ad-2-1921681019","title":"Installation du Serveur AD 2: 192.168.10.19","text":"<ul> <li> <p>J'ai install\u00e9 un deuxi\u00e8me serveur AD pour assurer la tol\u00e9rance aux pannes. </p> </li> <li> <p>J'ai effectu\u00e9 des \u00e9tapes telles que la configuration IP, la jonction au domaine, la configuration DNS et la mise en place d'un cluster DHCP. </p> <ul> <li>Tous les r\u00f4les installer ce r\u00e9plique sur l\u2019AD1 en cas de modification  </li> </ul> </li> </ul>"},{"location":"AP/AP%203/AP3/#serveur-de-fichiers","title":"Serveur de Fichiers:","text":"<ul> <li>Mon coll\u00e8gue a install\u00e9 un serveur permettant de partager des fichiers, de contr\u00f4ler les acc\u00e8s et de g\u00e9rer les ressources, y compris l'impression. </li> </ul>"},{"location":"AP/AP%203/AP3/#etapes-pour-le-serveur-de-fichiers","title":"\u00c9tapes pour le Serveur de Fichiers :","text":"<ul> <li> <p>Mon coll\u00e8gue a configur\u00e9 les param\u00e8tres IP (192.168.10.18) et ajouter le serveur au domaine. </p> </li> <li> <p>Mon coll\u00e8gue a cr\u00e9\u00e9 les dossiers principaux \"Perso\" et \"Groupe\". </p> </li> <li> <p>Mon coll\u00e8gue a attribu\u00e9 des permissions (NTFS et CIFS) pour g\u00e9rer l'acc\u00e8s local et le partage r\u00e9seau. </p> </li> </ul>"},{"location":"AP/AP%203/AP3/#periode-de-test","title":"P\u00e9riode de test :","text":""},{"location":"AP/AP%203/AP3/#la-replication","title":"La r\u00e9plication :","text":"<p>On a fait une modification par exemple sur les OU sur l\u2019AD2 pour voir si l\u2019AD1 le prenait en compte. </p>"},{"location":"AP/AP%203/AP3/#la-tolerance-aux-pannes","title":"La tol\u00e9rance aux pannes :","text":"<p>On a \u00e9teint l\u2019AD principale pour voir si les utilisateurs peuvent toujours joindre le domaine gr\u00e2ce au AD2 et v\u00e9rifier s'il ont bien une adresse IP gr\u00e2ce au cluster de DHCP qu\u2019on a pu mettre en place  </p>"},{"location":"AP/AP%203/AP3/#lagent-relais","title":"L\u2019agent relais :","text":"<p>On a modifi\u00e9 le fichier de configuration en enlevant 1 des DNS pour savoir si les AD reprenait bien un des deux DNS </p>"},{"location":"AP/AP%203/AP3/#dns","title":"DNS :","text":"<p>Effectuer un nslookup  pour v\u00e9rifier les diff\u00e9rents DNS </p>"},{"location":"BTS%20SIO%20/%20BTS%20SIO/","title":"BTS SIO","text":""},{"location":"BTS%20SIO%20/%20BTS%20SIO/#presentation-du-bts-sio","title":"Pr\u00e9sentation du BTS SIO","text":"<p>BTS SIO ( Service Informatique aux organisation ). C'est une formation qui se d\u00e9roule sur 2 ans.</p> <p>Dans cette formation, on \u00e9tudie trois grands axes qui sont :</p> Le d\u00e9veloppement <p></p> Le r\u00e9seaux <p></p> La cybers\u00e9curit\u00e9 <p></p>"},{"location":"BTS%20SIO%20/%20BTS%20SIO/#options-du-bts","title":"Options du BTS","text":""},{"location":"BTS%20SIO%20/%20BTS%20SIO/#ce-bts-ce-construit-autour-de-2-options","title":"Ce BTS ce construit autour de 2  options :","text":"<p>Option A : SISR (Solutions d'Infrastructure, Syst\u00e8mes et R\u00e9seau) :</p> <p>Cette option permet d\u2019approfondir le syst\u00e8me informatique. La conception et l'administration d'un r\u00e9seau informatique, d'un serveur en passant par l'administration et la supervision du r\u00e9seau</p> <p>Pour plus d'information sur l'option SISR cliquez-ici</p> <p>Option B : SLAM (Solution Logicielles et Applications M\u00e9tier) :</p> <p>Cette option permet d'approfondir le d\u00e9veloppement. La conception, d\u00e9veloppement des applications.</p> <p>Pour plus d'information sur l'option SLAM cliquez-ici</p>"},{"location":"CV%20/Mon%20CV/","title":"Mon CV","text":""},{"location":"Contact/Comment%20me%20contacter/","title":"Comment me contacter","text":""},{"location":"Contact/Comment%20me%20contacter/#pour-me-contacter","title":"Pour me contacter","text":"<ul> <li> <p>Par mail : antonin.lucas@bts-malraux.net</p> </li> <li> <p>Par t\u00e9l\u00e9phone :  07-70-01-38-03</p> </li> </ul>"},{"location":"Epreuve%20E4/Tableau%20de%20competence/","title":"Tableau de competence","text":""},{"location":"Epreuve%20E5/Situation%201/","title":"Situation 1","text":"<p>Lien de la situation</p>"},{"location":"Stage_2023_CD_72/CD72/","title":"Pr\u00e9sentation de l'organisme","text":""},{"location":"Stage_2023_CD_72/CD72/#le-conseil-departemental-de-la-sarthe","title":"LE CONSEIL D\u00c9PARTEMENTAL DE LA SARTHE","text":"<p>Le Conseil D\u00e9partemental est une collectivit\u00e9 territorial qui emploie environ 2500 agents \u00e0 travers tout le d\u00e9partement. Sa finalit\u00e9 est d'assurer le fonctionnement des services d'int\u00e9r\u00eat g\u00e9n\u00e9ral</p> <p>Le Conseil D\u00e9partemental poss\u00e8de des responsabilit\u00e9s nombreuses et diverses : la solidarit\u00e9 (famille, autonomie des personnes, emploi...), le d\u00e9veloppement des territoires (eau, r\u00e9seau \u00e9lectrique, d\u00e9veloppement durable...), la gestion des coll\u00e8ges, la gestion des routes, le sport, le tourisme et la culture.</p> <p>La Direction G\u00e9n\u00e9rale des Services (DGS) est ainsi divis\u00e9e en trois Directions G\u00e9n\u00e9rales Adjointes (DGA) qui se r\u00e9partissent ces missions, et la Direction d\u2019Appui \u00e0 la Performance (DAP) qui occupe un r\u00f4le transverse.</p>"},{"location":"Stage_2023_CD_72/CD72/#la-direction-des-systemes-dinformation-et-du-numerique","title":"LA DIRECTION DES SYST\u00c8MES D\u2019INFORMATION ET DU NUM\u00c9RIQUE","text":"<p>La Direction des Syst\u00e8mes d\u2019Information et du Num\u00e9rique (DSIN) fait partie de la DGA Ressources. Son r\u00f4le est expliqu\u00e9 ainsi dans l\u2019annuaire des services :</p> <p>\u201cLa Direction des Syst\u00e8mes d\u2019information et du num\u00e9rique (DSIN) est en charge de la transformation digitale et de la modernisation de l\u2019organisation. Elle assure le pilotage et le d\u00e9veloppement du syst\u00e8me d\u2019information de la collectivit\u00e9, des solutions de t\u00e9l\u00e9communications, la mise en \u0153uvre des nouvelles technologies, ainsi que la promotion des usages num\u00e9riques, \u00e0 titre interne (dans les services) et \u00e0 titre externe (sur le territoire d\u00e9partemental). Elle \u00e9labore et pilote les plans de num\u00e9risation et de renouvellement des syst\u00e8mes d\u2019information, et assure la maintenance et le support sur l\u2019ensemble des solutions num\u00e9riques et en garantit la s\u00e9curisation.\u201d</p> <p>En somme, la DSIN a la charge du parc informatique du Conseil D\u00e9partemental, des syst\u00e8mes et r\u00e9seaux mis \u00e0 disposition des agents et des applications utilis\u00e9es par les divers m\u00e9tiers. Cette responsabilit\u00e9 va de la r\u00e9ponse aux besoins exprim\u00e9s par les agents, jusqu\u2019\u00e0 la maintenance et l\u2019assistance informatique. La DSIN s\u2019occupe \u00e9galement de certains projets relatifs \u00e0 la politique publique du num\u00e9rique.</p> <p>La DSIN comprend plusieurs services, et j\u2019ai pour ma part \u00e9t\u00e9 int\u00e9gr\u00e9e au service Conception &amp; Architecture, dont mon ma\u00eetre de stage est le chef de service.</p> <p>Ce service comprend :</p> <ul> <li> <p>Les architectes (technique et SI/Data)</p> </li> <li> <p>Le responsable s\u00e9curit\u00e9</p> </li> <li> <p>Les admins syst\u00e8mes</p> </li> <li> <p>Le bureau r\u00e9seaux &amp; t\u00e9l\u00e9coms</p> </li> </ul>"},{"location":"Stage_2023_CD_72/Besoin%20du%20CD72/besoin/","title":"Pourquoi avoir effectuer cette mission","text":"<p>J'ai pu effectuer cette mission en collaboration avec le service de la DSIN du d\u00e9partement en vue d'une exp\u00e9rimentation pour leurs projets futurs. </p>"},{"location":"Stage_2023_CD_72/Documentation/Docker-compose/","title":"Docker-compose, apache, php, mariadb","text":""},{"location":"Stage_2023_CD_72/Documentation/Docker-compose/#cest-quoi-docker-compose","title":"C\u2019est quoi Docker-compose :","text":"<p>C\u2019est un outil qui permet de d\u00e9finir et g\u00e9rer des applications multi-conteneurs. Ce docker utilise un fichier YAML (Repr\u00e9sentation des informations lisible par l\u2019Homme).</p>"},{"location":"Stage_2023_CD_72/Documentation/Docker-compose/#configurer-docker-compose","title":"Configurer Docker-compose :","text":"<p>Tout d\u2019abord, il faudra cloner votre d\u00e9p\u00f4t git sur votre VM :</p> <p>Revoir mission 24/05 : lien pour le d\u00e9partement.</p> <p>Allez dans le titre \u201cConfiguration pour \u201ccloner\u201d et \u201cpush\u201d sur Ubuntu : \u201d</p> <p>Ensuite, il faudra aller \u00e0 la racine du d\u00e9p\u00f4t et cr\u00e9er diff\u00e9rent dossier :</p>"},{"location":"Stage_2023_CD_72/Documentation/Docker-compose/#docker-composeyml","title":"Docker-compose.yml :","text":"<pre><code>version: '3.7'\n\nservices: \n  db:\n    image: mariadb:10   #Service du container \n    container_name: mariadb  #Son nom\n    restart: always    #Il reste toujours allumer\n    ports: ['3306:3306']\n    volumes:          #Endroit stock les information et donn\u00e9es du container\n      - ./db_data:/var/lib/mysql\n      - ./backups:/backups\n    environment:\n      MYSQL_DATABASE: $MYSQL_DATABASE\n      MYSQL_USER: $MYSQL_USER\n      MYSQL_PASSWORD: $MYSQL_PASSWORD\n      MYSQL_ALLOW_EMPTY_PASSWORD: 'no'\n      MYSQL_ROOT_PASSWORD: $MYSQL_ROOT_PASSWORD\n    env_file:\n      - .env  #Il va chercher les information de ce fichier la\n\n  web:\n    build: .  #Il contruit le containeur \u00e0 la racine du d\u00e9p\u00f4t\n    container_name: apache2\n    restart: always\n    depends_on: ['db']\n    ports: ['80:80'] #num\u00e9ros de port de sortie du containeur\n    links: ['db:db']\n    volumes:\n      - './www:/var/www/html' #Endroit o\u00f9 il va chercher le contenu et stocker \n    environment: #Il va r\u00e9cuper les donn\u00e9es de la base de donn\u00e9es\n      MYSQL_DB_HOST: db\n      MYSQL_DATABASE: $MYSQL_DATABASE\n      MYSQL_USER: $MYSQL_USER\n      MYSQL_PASSWORD: $MYSQL_PASSWORD\n\n    env_file:\n      - .env  #Il va chercher les information de ce fichier la\n</code></pre>"},{"location":"Stage_2023_CD_72/Documentation/Docker-compose/#backups-db_data-www","title":"Backups, db_data, www :","text":"<p>Il faudra cr\u00e9er ces fichiers dans le d\u00e9p\u00f4t pour les \u201cVolumes\u201d.</p>"},{"location":"Stage_2023_CD_72/Documentation/Docker-compose/#installer-wordpress-sur-le-dossier-www","title":"Installer WordPress sur le dossier \u201cwww\u201d :","text":"<p>WordPress est un syst\u00e8me de gestion de contenu gratuit, libre et open source. Ce logiciel \u00e9crit en php repose sur une base de donn\u00e9es MySQL.</p> <p>Pour installer WordPress sur \u201cwww\u201d, il vous suffira de vous placer dedans :</p> <pre><code> \u201ccd www/\u201d\n</code></pre> <p>Et de faire la commande :</p> <pre><code> \u201d wget https://wordpress.org/latest.zip \u201c\n</code></pre>"},{"location":"Stage_2023_CD_72/Documentation/Docker-compose/#attention","title":"Attention","text":"<p>Il faut penser \u00e0 \u201cunzip\u201c le fichier \u201clatest.zip\u201c </p> <p>Pour cela il faudra installer le paquet unzip :</p> <pre><code>\u201csudo apt install unzip\u201d\n</code></pre> <p>Enfin faite la commande dans \u201cwww\u201d :</p> <pre><code>\u201cunzip latest.zip\u201d        \n</code></pre> <p>Pour que le WordPress fonctionne il faut installer une extension php </p>"},{"location":"Stage_2023_CD_72/Documentation/Docker-compose/#dockerfiles","title":"DockerFiles  :","text":"<p>Les Dockerfile vous permettent de configurer et de cr\u00e9er rapidement une image pour la rendre plus partageable facilement.</p> <p>Il vous suffira de cr\u00e9er un fichier Dockerfile  toujours \u00e0 l\u2019int\u00e9rieur de votre d\u00e9p\u00f4t : </p> <pre><code>FROM    php:7.4-apache \n#Il va chercher le php apache \nRUN     docker-php-ext-install mysqli\n#Et il va installer l'extension \n</code></pre>"},{"location":"Stage_2023_CD_72/Documentation/Docker-compose/#attention_1","title":"Attention","text":"<p>Il faudra modifier les droits de \u201dwww\u201d : \u201dchmod -R 777.\u201d</p>"},{"location":"Stage_2023_CD_72/Documentation/Docker-compose/#lancement-docker-compose","title":"Lancement docker-compose :","text":"<p>Une fois tout cela configurer vous pourrez lancer la commande : </p> <pre><code>\u201csudo docker-compose up\u201d\n</code></pre> <p>Cela va lancer votre docker-compose. Il vous suffira d'ouvrir un navigateur et taper le nom de votre machine et vous verrez wordpress Il faudra renseigner le nom de votre site et les informations de votre BDD pr\u00e9c\u00e9demment d\u00e9finis dans le fichier \u201cdocker-compose\u201d</p> <p>Voil\u00e0 votre site sur le serveur Apache sur un docker. Maintenant laisser les devs travailler !</p>"},{"location":"Stage_2023_CD_72/Documentation/Docker-compose/#push-le-depot-sans-avoir-acces-au-id-de-connexion-et-au-mot-de-passe","title":"Push le d\u00e9p\u00f4t sans avoir acc\u00e8s au ID de connexion et au mot de passe :","text":"<p>Il est important de savoir faire cela car si vous mettez tous vos dossiers dans votre d\u00e9p\u00f4t public et que dans ces dossiers tout le monde peut acc\u00e9der \u00e0 vos de mot de passe. Votre site sera en aucun cas s\u00e9curis\u00e9.</p>"},{"location":"Stage_2023_CD_72/Documentation/Docker-compose/#gitignore","title":".gitignore :","text":"<p>Ce fichier sert \u00e0 indiquer quels fichiers il va ignorer pendant le push, pour cela il faudra cr\u00e9er ce fichier toujours dans votre d\u00e9p\u00f4t. Il faudra inscrire dans ce fichier les fichiers sensibles envers votre site :</p> <pre><code>www/\nbackups/\ndb_data/\n.env\n</code></pre> <p>Quand vous allez faire un push dans votre git-lab c\u2019est fichier n\u2019y seront pas.</p>"},{"location":"Stage_2023_CD_72/Documentation/Docker-compose/#env","title":".env :","text":"<p>Le fichier .env est un fichier cach\u00e9 sur votre vm qui permet de d\u00e9clarer des variables pour les informations importantes, par exemple : </p> <p>\u201cMYSQL_PASSWORD = Votre password\u201d</p> <p>Votre fichier doit ressembler \u00e0 sa :</p> <pre><code>#Declaration Variable \n\n\nMYSQL_USER : NOMUTILISATEUR \n\nMYSQL_PASSWORD : MOTPASSEUSER  \n\nMYSQL_ROOT_PASSWORD : MOTDEPASSEROOT\n\nMYSQL_DATABASE : NOMBASE \n</code></pre>"},{"location":"Stage_2023_CD_72/Documentation/Docker-compose/#env_sample","title":".env_sample :","text":"<p>Pour aider les gens \u00e0 cr\u00e9er leur \u201c.env\u201d sans mettre vos informations, il est possible de faire un exemple et ce fichier contrairement au \u201c.env\u201d sera push dans le d\u00e9p\u00f4t.</p> <p>Une fois tout cela configurer, il vous suffira de push votre d\u00e9p\u00f4t sur la VM et vos fichiers seront sur le git-lab en ligne.</p> <p>Rappel pour push : Faite un \u201cgit add \u2013 A\u201d, puis un \u201cgit commit \u2013m \u201d, enfin le \u201cgit push\u201d"},{"location":"Stage_2023_CD_72/Documentation/GITHUB/","title":"Cr\u00e9ation d'un d\u00e9p\u00f4t GITHUB pour h\u00e9berger mon Portfolio","text":""},{"location":"Stage_2023_CD_72/Documentation/GITHUB/#comment-cree-un-depot-github","title":"Comment cr\u00e9e un d\u00e9pot GITHUB","text":"<p>Tout d'abord il faudra vous rendre sur ce site : GITHUB</p> <p>Il faudra vous connectez avec vos codes fourni aux pr\u00e9alables :</p> <p></p> <p>Une fois connect\u00e9 il faudra Cliquer sur \"new\" en haut \u00e0 droite de la page</p> <p></p> <p>Ensuite renseigner les informations suivante :</p> <p></p> <p>Voil\u00e0 votre d\u00e9p\u00f4t GITHUB cr\u00e9er !!</p>"},{"location":"Stage_2023_CD_72/Documentation/GITHUB/#activer-la-page-web","title":"Activer la page web","text":"<p>Aller dans l'onglet \"settings\" </p> <p>Puis aller dans l'onglet pages :</p> <p></p> <p>Vous devriez arriver sur cet onglet : </p> <p></p>"},{"location":"Stage_2023_CD_72/Documentation/GITHUB/#creation-fichier-ciyml","title":"Cr\u00e9ation fichier \"ci.yml\"","text":"<p>Ce fichier est un script qui permet de construire et de d\u00e9ployer son site automatiquement</p> <p>Pour ce faire :</p> <pre><code>mkdir .github\nmkdir workflows\nvim ci.yml\n</code></pre> <p>Ensuite il faudra inscrire ceci dans le fichier :</p> <pre><code>name: Deploy to GitHub Pages\n\non:\n  push:\n    branches:\n      - main\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n\n    steps:\n      - name: Checkout repository\n        uses: actions/checkout@v2\n\n      - name: Set up Python\n        uses: actions/setup-python@v2\n        with:\n          python-version: 3.x\n\n      - name: Install dependencies\n        run: |\n          pip install mkdocs mkdocs-material mkdocs-mermaid2-plugin\n\n      - name: Build site\n        run: mkdocs build --verbose --clean\n\n      - name: Deploy to GitHub Pages\n        uses: peaceiris/actions-gh-pages@v3\n        with:\n          github_token: ${{ secrets.GITHUB_TOKEN }}\n          publish_dir: site\n</code></pre>"},{"location":"Stage_2023_CD_72/Documentation/GITHUB/#attention","title":"Attention","text":"<p>Il faudra penser \u00e0 mettre le deploy dans la bonne branche</p> <p>Pour ce faire aller dans \"settings\"</p> <p>Puis aller sur l'onget \"pages\" :</p> <p></p> <p>Ensuite s\u00e9lectionner github action</p> <p></p> <p>et vous allez mettre \"Deploy from a branch\" :</p> <p></p>"},{"location":"Stage_2023_CD_72/Documentation/GITHUB/#attention_1","title":"Attention","text":"<p>Il faudra penser \u00e0 mettre les bons droits pour le workflows</p> <p>Pour ce faire aller dans \"settings\"</p> <p>Ensuite aller dans l'onglet \"actions\" :</p> <p></p> <p>Ensuite il faudra descendre jusqu'\u00e0 trouver ceci : </p> <p></p> <p>Cocher les m\u00eames choses que moi !</p> <p>Pensez \u00e0 \"save\"</p> <p>Voil\u00e0 d\u00e9p\u00f4t pr\u00eat \u00e0 \u00eatre utiliser !!! </p>"},{"location":"Stage_2023_CD_72/Documentation/GITLAB/","title":"SSH : Cl\u00e9 priv\u00e9e, cl\u00e9 publique, gitlab","text":""},{"location":"Stage_2023_CD_72/Documentation/GITLAB/#generer-cle-privee-cle-publique-windows","title":"G\u00e9n\u00e9rer cl\u00e9 priv\u00e9e, cl\u00e9 publique (Windows) :","text":"<p>Pour se faire il faudra ouvrir un powershell, puis taper la commande : </p> <pre><code>ssh-keygen\n</code></pre> <p>Ensuite, il va vous g\u00e9n\u00e9rer une cl\u00e9 priv\u00e9e et publique dans cet emplacement :</p> <pre><code>\u201cC:\\Users\\&lt;votre User&gt;/.ssh/id_rsa\u201d\n</code></pre> <p>Voil\u00e0 vos cl\u00e9es cr\u00e9ent</p>"},{"location":"Stage_2023_CD_72/Documentation/GITLAB/#generer-cle-privee-cle-publique-ubuntu","title":"G\u00e9n\u00e9rer cl\u00e9 priv\u00e9e, cl\u00e9 publique (Ubuntu) :","text":"<p>Pour se faire, il faudra taper la m\u00eame commande que celle de windows :</p> <pre><code>ssh-keygen\n</code></pre> <p>Ensuite, il va vous g\u00e9n\u00e9rer une cl\u00e9 priv\u00e9e et publique dans cet emplacement :</p> <pre><code>\u201c/home/ubuntu/.ssh/id_rsa\u201d\n</code></pre>"},{"location":"Stage_2023_CD_72/Documentation/GITLAB/#utiliser-la-vm-sur-le-powershell-de-windows","title":"Utiliser la VM sur le Powershell de Windows :","text":"<p>Il vous suffira de copier la cl\u00e9 publique de Windows sur le fichier \u201cauthorized_keys\u201d qui se trouve dans \u201c/home/ubuntu/.ssh\u201d et de sauvegarder le fichier.</p> <p>Pour utiliser la VM sur le powershell de Windows, il faudra taper la commande :</p> <pre><code>\u201cssh &lt;user&gt;@&lt;adresse Ip de la VM&gt; ou &lt;le nom de domaine&gt;\u201d\n</code></pre> <p>Ensuite, il vous posera une question : Il faudra r\u00e9pondre \u201cyes\u201d</p> <p>Enfin vous serez connect\u00e9 en ssh \u00e0 la VM </p>"},{"location":"Stage_2023_CD_72/Documentation/GITLAB/#connecter-la-vm-sur-visual-code","title":"Connecter la VM sur Visual Code :","text":"<p>Pour connecter sa VM, il faut commencer par installer une extension sur Visual Code. Pour cela il faut aller dans extension.</p> <p>Ensuite il faudra rechercher \u201cremote\u201c et installer le premier qui appara\u00eet.</p> <p>Une fois installer, il y aura une ic\u00f4ne bleue en bas \u00e0 gauche de l\u2019application.</p> <p>Il faudra cliquer dessus, ensuite </p> <pre><code>Cliquer sur \u201cConnect to Host...\u201d\nEnsuite cliquer sur \u201c+ Add New SSH Host...\u201d\n</code></pre> <p>Ensuite il faudra renseigner :</p> <pre><code>\u201cssh &lt;user&gt;@&lt;adresse Ip de la VM&gt; ou &lt;le nom de domaine&gt;\u201d\n</code></pre> <p>Ensuite au m\u00eame endroit il vous demandera la distribution utiliser : (Linux, Windows, Mac), choisissez ce dont vous avez besoin. </p> <p>Vous voil\u00e0 connectez \u00e0 la VM sur Visual Code !!</p>"},{"location":"Stage_2023_CD_72/Documentation/GITLAB/#creer-un-depot-sur-git-lab-et-le-pouvoir-cloner-et-push-grace-a-git-sur-ubuntu","title":"Cr\u00e9er un d\u00e9p\u00f4t sur Git-lab et le pouvoir \u201cCloner\u201d et \u201cpush\u201d gr\u00e2ce \u00e0 \u201cGIT\u201d sur UBUNTU :","text":"<p>Il vous suffira de vous connecter au git-lab du conseil d\u00e9partemental : Lien GitLab</p> <p>Avec vos codes fournit au pr\u00e9alable.</p>"},{"location":"Stage_2023_CD_72/Documentation/GITLAB/#creation-du-depot","title":"Cr\u00e9ation du d\u00e9p\u00f4t :","text":"<p>Cliquez sur \u201cCreate blank project\u201d.</p> <p>Ensuite donner un nom au projet et appuyer sur \u201cCreate project\u201d.</p>"},{"location":"Stage_2023_CD_72/Documentation/GITLAB/#configuration-pour-cloner-et-push-sur-ubuntu","title":"Configuration pour \u201ccloner\u201d et \u201cpush\u201d sur Ubuntu :","text":"<p>Une fois le d\u00e9p\u00f4t cr\u00e9er, il faudra ajouter vos cl\u00e9s publiques (Ubuntu et Windows) sur Git-Lab.</p> <p>Pour ce faire, il faut se rendre sur votre profil (Icone en haut \u00e0 droite) et cliquer sur pr\u00e9f\u00e9rences.</p> <p>En cliquant sur pr\u00e9f\u00e9rences, sur la gauche de l\u2019\u00e9cran il y aura \u201cSSH keys\u201d cliquez dessus. </p> <p>Ensuite, copier-coller une des deux cl\u00e9s publiques \u201cdans Key\u201d, donnez-lui un titre et ajoutez-la.</p> <p>Faites la m\u00eame manipulation pour la deuxi\u00e8me cl\u00e9 publique.</p> <p>Ensuite retournez sur votre d\u00e9p\u00f4t et copier le lien ssh.  </p> <p>Puis retournez sur votre VM coller ce que vous venez copier en rajoutant au d\u00e9but \"git clone\".</p> <p>Suite \u00e0 cette commande, votre d\u00e9p\u00f4t sera dans votre VM.</p> <p>Maintenant depuis votre d\u00e9p\u00f4t vous pourrez travailler sur votre VM et mettre vos travaux sur ce d\u00e9p\u00f4t.</p>"},{"location":"Stage_2023_CD_72/Documentation/GITLAB/#maintenant-nous-allons-voir-comment-push-nos-dossier-de-travail-qui-sont-present-dans-notre-depot-sur-la-vm-directement-dans-git-lab","title":"Maintenant, nous allons voir comment \u201cpush\u201d nos dossier de travail qui sont pr\u00e9sent dans notre d\u00e9p\u00f4t sur la VM directement dans Git-lab.","text":"<p>Apr\u00e8s avoir mis un fichier dans le d\u00e9p\u00f4t il vous suffira de faire 3 commandes \u00e0 la suite :</p> <pre><code>git add -A\n( Il va ajouter le nouveau fichier cr\u00e9er dans le d\u00e9p\u00f4t)\n</code></pre> <pre><code>git commit -m rapport\n(C\u2019est pour indiquer un message pour le fichier push) moi par exemple c\u2019est \u201drapport\u201d\n</code></pre> <pre><code>git push\n(La derni\u00e8re commande permet d\u2019envoyer ce fichier dans le git-lab)\n</code></pre> <p>Voil\u00e0 comment cr\u00e9er un d\u00e9p\u00f4t dans Git-lab et de pouvoir le cloner et le push sur git-lab sous Ubuntu.</p>"},{"location":"Stage_2023_CD_72/Documentation/GITLAB/#configuration-pour-cloner-et-push-sur-windows","title":"Configuration pour \u201ccloner\u201d et \u201cpush\u201d sur Windows :","text":"<p>Sur Windows, il vous suffira d\u2019installer Git pour Windows : Lien t\u00e9l\u00e9chargement Git</p> <p>Une fois installer, les commandes seront les m\u00eames que celles de Linux </p>"},{"location":"Stage_2023_CD_72/Documentation/Mkdocs/","title":"Mkdocs","text":""},{"location":"Stage_2023_CD_72/Documentation/Mkdocs/#intallation-mkdocs","title":"Intallation MkDocs","text":"<p>Tout d'abord, il faudra installer le paquet \"pip\"</p> <pre><code>sudo apt install pip\n</code></pre> <p>Ensuite installer MkDocs</p> <pre><code> pip install MkDocs\n</code></pre> <p>Apr\u00e8s l'installation, dans votre r\u00e9pertoire de travail, ex\u00e9cutez la commande suivante pour initialiser un site :</p> <pre><code>mkdocs new mkdocspro\n</code></pre> <p>Ensuite placer vous dans le dossier :</p> <pre><code>cd mkdocspro\n</code></pre> <p>Ensuite faite cette commande pour savoir l'url du site :</p> <pre><code>mkdocs serve\n</code></pre> <p>Si tous est fait correctement vous devriez arriver sur une page comme celle ci !</p>"},{"location":"Stage_2023_CD_72/Documentation/Mkdocs/#installation-docker-par-script","title":"Installation Docker par script","text":"<p>Sur le GitLab du d\u00e9partement : Lien GitLab</p> <p>Dans la barre de recherche taper \"ansible localhost\" </p> <p>Cloner sur votre Vm le d\u00e9p\u00f4t.</p> <p>Ensuite aller dans ce dossier et faite :</p> <pre><code> sudo ansible-galaxy install -f -r requirements.yml\n</code></pre> <pre><code>  sudo sudo ansible-playbook  pb_install_docker.yml\n</code></pre>"},{"location":"Stage_2023_CD_72/Documentation/Mkdocs/#heberger-le-site-avec-nginx-avec-un-dockerfile","title":"H\u00e9berger le site avec Nginx avec un dockerfile","text":""},{"location":"Stage_2023_CD_72/Documentation/Mkdocs/#creer-un-depot-sur-git-et-le-cloner","title":"Cr\u00e9er un d\u00e9p\u00f4t sur git et le cloner","text":"<p>Pour ce faire aller voir La mission du 24.05 !</p>"},{"location":"Stage_2023_CD_72/Documentation/Mkdocs/#mettre-le-contenu-de-mkdocs-dans-le-depot","title":"Mettre le contenu de MkDocs dans le d\u00e9p\u00f4t","text":"<p>Il faudra faire :</p> <pre><code>mv &lt;nom du fichier&gt; &lt;la destination&gt;\n</code></pre>"},{"location":"Stage_2023_CD_72/Documentation/Mkdocs/#creation-du-dockerfile","title":"Cr\u00e9ation du Dockerfile","text":"<p>Il faudra cr\u00e9er un \"Dockerfile\" dans le d\u00e9p\u00f4t pr\u00e9cedemment cr\u00e9e </p> <pre><code>vim Dockerfile\n</code></pre> <p>Une fois cr\u00e9er il faudra ins\u00e9rer ceci :</p> <pre><code>FROM nginx:latest\n\n# Copiez les fichiers g\u00e9n\u00e9r\u00e9s de MkDocs dans le r\u00e9pertoire du serveur Nginx\nCOPY site /usr/share/nginx/html\n\n# Copiez la configuration Nginx personnalis\u00e9e\nCOPY nginx.conf /etc/nginx/conf.d/default.conf\n</code></pre>"},{"location":"Stage_2023_CD_72/Documentation/Mkdocs/#creation-du-fichier-conf-nginx","title":"Cr\u00e9ation du fichier conf Nginx","text":"<p>Il faudra cr\u00e9e ce fichier toujours dans le d\u00e9p\u00f4t </p> <pre><code>vim nginx.conf\n</code></pre> <p>Une fois cr\u00e9er il faudra ins\u00e9rer ceci :</p> <pre><code>server {\n    listen 80;\n    server_name localhost;\n\n    location / {\n        root /usr/share/nginx/html;\n        index index.html;\n    }\n}\n</code></pre>"},{"location":"Stage_2023_CD_72/Documentation/Mkdocs/#creation-de-limage-docker","title":"Cr\u00e9ation de l'image Docker","text":"<p>Pour construire l'image il faudra taper cette commande : </p> <pre><code>docker build -t monsite-mkdocs .\n</code></pre> <p>Il vous suffira d'\u00e9x\u00e9cuter le conteneur :</p> <pre><code>docker run -d -p 8080:0 monsite-mkdocs\n</code></pre> <p>Si tous est fait correctement vous devriez arriver sur une page comme celle ci ! Et votre site est h\u00e9berger sur un docker nginx</p>"},{"location":"Stage_2023_CD_72/Documentation/Mkdocs/#heberger-le-site-avec-nginx-avec-docker-compose","title":"H\u00e9berger le site avec Nginx avec docker-compose","text":"<p>Tout d'abord supprimer le fichier \"Dockerfiles\"</p> <p>Ensuite dans le d\u00e9p\u00f4t, il faudra cr\u00e9er le fichier \"docker-compose.yml\" et mettre ceci :</p> <pre><code>version: '3'\n\nservices:\n  nginx-server:\n    container_name: nginx  #Son nom\n    #restart: always    #Il reste toujours allumer\n    image: nginx:latest\n    ports:\n      - 8080:80\n    volumes:\n     ## - ./nginx.conf:/etc/nginx/conf.d/default.conf\n      - ./site:/usr/share/nginx/html\n</code></pre> <p>Si tous est fait correctement vous devriez arriver sur une page comme celle ci ! Et votre site est h\u00e9berger sur un docker nginx en permanance</p>"},{"location":"Stage_2023_CD_72/Documentation/Mkdocs/#bonus","title":"Bonus","text":""},{"location":"Stage_2023_CD_72/Documentation/Mkdocs/#installer-un-navigateur-en-ligne-de-commande","title":"Installer un navigateur en ligne de commande","text":"<p>Faite un : </p> <pre><code>sudo apt install lynx\n</code></pre> <p>Pour l'utiliser par exemple \"Google \":</p> <pre><code>lynx https://google.com\n</code></pre> <p>R\u00e9pondez \"A\" aux questions qu'il vous pose.</p> <p>Et voil\u00e0 vous avez un navigateur internet en ligne de commande</p>"},{"location":"Stage_2023_CD_72/Documentation/Multipass%26docker/","title":"Multipass, docker","text":""},{"location":"Stage_2023_CD_72/Documentation/Multipass%26docker/#installer-multipass","title":"Installer multipass :","text":"<p>Multipass c\u2019est un outil comme VirtualBox cela permet d'ouvrir un shell avec la distribution souhaiter. Lien pour installer Multipass</p>"},{"location":"Stage_2023_CD_72/Documentation/Multipass%26docker/#hyper-g","title":"Hyper G :","text":"<p>C\u2019est un logiciel qui permet de g\u00e9rer les VM. C\u2019est un gestionnaire  Voici le chemin pour s\u2019y rendre : </p> <pre><code>C:\\Windows\\System32\\virtmgmt.msc\n</code></pre>"},{"location":"Stage_2023_CD_72/Documentation/Multipass%26docker/#configurer-une-nouvelle-vm","title":"Configurer une nouvelle VM :","text":"<p>Ceci affiche le shell :</p> <pre><code>multipass shell\n</code></pre> <pre><code>multipass stop primary\n\nIl faudra penser tout d\u2019abord supprimer la machine par d\u00e9faut \u201cPrimary\u201d \n</code></pre> <pre><code>multipass launch -c 4 -m 8G -d 20G -n servernew 20.04\n\nEnsuite il faudra lancer la VM avec \u201cLaunch\u201d, le \u201c-c\u201d c\u2019est pour les c\u0153urs de la VM, \u201c\u2013m\u201d c\u2019est pour la m\u00e9moire, \u201c-d\u201d pour le stockage du disque dur, \u201c-n\u201d le nom de la VM et \u201c20.04\u201d la version de la distribution et \u00e0 la fin rajouter \u201c--cloud-init &lt;Chemin de ce fichier&gt;\u201d\n</code></pre> <p>Pour lancer notre VM il suffira de faire la commande :</p> <pre><code>\u201cmultipass start &lt; nom de la machine &gt;\u201d \n</code></pre>"},{"location":"Stage_2023_CD_72/Documentation/Multipass%26docker/#installation-docker","title":"Installation Docker :","text":"<p>Tout d\u2019abord, il faut mettre \u00e0 jour les paquets : </p> <pre><code>sudo apt update\n</code></pre> <p>Ensuite, il faudra installer des paquets pr\u00e9requis pour HTTPS :</p> <pre><code>sudo apt install apt-transport-https ca-certificates curl software-properties-common\n</code></pre> <p>Ensuite il faudra ajouter la cl\u00e9 GPG du d\u00e9p\u00f4t de docker sur votre syst\u00e8me :</p> <pre><code>curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add - \n</code></pre> <p>Ajoutez le r\u00e9f\u00e9renciel Docker aux sources APT :</p> <pre><code>sudo add-apt-repository \"deb [arch-amd64] https://download.docker.com/linux/ubuntu focal stable\n</code></pre> <p>Gr\u00e2ce \u00e0 cela, il faudra mettre \u00e0 jour la base de donn\u00e9es : </p> <pre><code>sudo apt update\n</code></pre> <p>Il faudra config l\u2019installation sur le d\u00e9p\u00f4t de docker et non sur celui d\u2019ubuntu : </p> <pre><code>apt-cache policy docker-ce\n</code></pre> <p>Enfin, vous pourrez installer docker : </p> <pre><code>sudo apt install docker-ce\n</code></pre> <p>Ensuite, vous devrez activer docker :  </p> <pre><code>sudo systemctl status docker\n</code></pre>"},{"location":"Stage_2023_CD_72/Documentation/Multipass%26docker/#configuration-docker","title":"Configuration docker :","text":"<p>Il vous suffira de vous connecter au git-lab du conseil d\u00e9partemental : GitLab d\u00e9partement  Avec vos codes fournit au pr\u00e9alable.</p> <p>Ensuite dans la barre de recherche :  taper \u201dlocalhost\u201d</p> <p>Ensuite cliquer sur clone et copier le lien https. </p> <p>Ensuite, une fois le lien copier, il faudra le coller sur la VM :</p> <pre><code>git clone &lt;lien ssh&gt;\n</code></pre> <p>Une fois cela fait il faudra vous rendre dans le dossier \u201cansible_localhost\u201d : \u201ccd ansible_localhost\u201d</p> <p>Ensuite, faite la commande \u201ccat README.md\u201d cela vous am\u00e8nera \u00e0 l\u2019int\u00e9rieur du script :</p> <pre><code>sudo ansible-galaxy install -f -r requirements.yml\n\nsudo ansible-playbook pb_install_docker.yml\n</code></pre> <p>Puis copier la ligne juste en-dessous de bash en rajoutant sudo avant.</p> <p>M\u00eame chose pour le 2\u00e8me Bash.</p>"},{"location":"Stage_2023_CD_72/Documentation/Multipass%26docker/#installer-une-image-docker","title":"Installer une image Docker :","text":"<p>Il vous suffira de faire un \u201csudo docker run \u201d"},{"location":"Stage_2023_CD_72/Documentation/Multipass%26docker/#heberger-une-page","title":"H\u00e9berger une page :","text":"<p>Tout d\u2019abord cr\u00e9er un dossier \u201cDocker\u201d, ensuite dans ce dossier cr\u00e9er en fichier dockerfile et un fichier .html.</p> <p>Dans le fichier \u201cdockerfile\u201d il faut inscrire du code :</p> <pre><code>FROM nginx\n\nCOPY . /usr/share/nginx/html\n</code></pre> <p>Cela permet que \u00e0 chaque fois qu\u2019on lance le docker nginx le fichier html se lance et cela permet que \u00e0 chaque fois que on quitte le docker on ne perd ce qu\u2019on a fait.</p> <p>Et inscrivez dans le fichier html votre code html</p> <p>Ensuite placer vous dans le dossier Docker et taper cette commande : </p> <pre><code>docker build -t nginx-myapplication\n</code></pre> <p>Pour finir, taper la commande :</p> <pre><code>docker run --name &lt;nom conteneur&gt; -p &lt;port&gt; -d &lt;nom image&gt;\n</code></pre> <p>Pour v\u00e9rifier que cela fonctionne, allez sur un navigateur et taper :  : /. <p>Vous devriez voir votre page html.</p>"},{"location":"Stage_2023_CD_72/Documentation/Multipass%26docker/#conclusion","title":"Conclusion :","text":"<p>Cette mission m\u2019a permis de d\u00e9couvrir deux logiciels qui sont : Multipass et Hyper V</p> <p>Elle m\u2019a aussi permis de configurer une VM sur cette plateforme.</p> <p>Elle m\u2019a permis de voir diff\u00e9rentes possibilit\u00e9s avec docker. Comment le configurer ? Comment l\u2019installer ? </p>"},{"location":"Stage_2023_CD_72/Documentation/Registry%20docker/","title":"Installation SRV-DOCK et Registry Docker","text":""},{"location":"Stage_2023_CD_72/Documentation/Registry%20docker/#registry-docker-cest-quoi","title":"Registry Docker c\u2019est quoi ?","text":"<p>Le registre Docker est une m\u00e9thode standard de stockage et de distribution des images Docker. Le registre est un r\u00e9f\u00e9rentiel open source sous licence d'autorisation Apache. Le registre Docker permet \u00e9galement d'am\u00e9liorer le contr\u00f4le d'acc\u00e8s et la s\u00e9curit\u00e9 des images Docker stock\u00e9es dans son r\u00e9f\u00e9rentiel.</p>"},{"location":"Stage_2023_CD_72/Documentation/Registry%20docker/#installation-srv-tst-docker","title":"Installation SRV-TST-DOCKER :","text":"<p>Pour installer le serveur, je l\u2019ai fait sur l\u2019outil de virtualisation VMWARE. L\u2019installation c\u2019est fait gr\u00e2ce \u00e0 des scripts ansible ce qui permet une installation rapide et automatique. </p>"},{"location":"Stage_2023_CD_72/Documentation/Registry%20docker/#installation-registry-docker","title":"Installation Registry docker","text":"<p>Cr\u00e9ation du Registry priv\u00e9 :</p> <pre><code>\u201cdocker run -d -p 5000:5000 --restart=always --name mon-registry registry:2\u201d\n</code></pre>"},{"location":"Stage_2023_CD_72/Documentation/Registry%20docker/#deposer-une-image-dans-le-registry-prive","title":"D\u00e9poser une image dans le Registry priv\u00e9 :","text":"<p>Tout d\u2019abord il faudra cr\u00e9er un DockerFile :</p> <p></p> <p>Ensuite il faudra construire votre image : </p> <p></p> <p>Ensuite, il faudra tag votre image pour pouvoir push l\u2019image sur le registry docker </p> <p></p> <p>Enfin vous pourrez push votre image dans votre registry :</p> <p></p>"},{"location":"Stage_2023_CD_72/Documentation/Registry%20docker/#visualiser-les-images-disponibles-dans-le-registry-prive","title":"Visualiser les images disponibles dans le Registry priv\u00e9:","text":"<p>Voici l\u2019url pour y acc\u00e8der : </p> <p>Lien pour acceder au registry</p> <p>Voici ce que vous aurez comme r\u00e9sultat : </p> <p></p>"},{"location":"Stage_2023_CD_72/Documentation/Registry%20docker/#visualiser-les-differents-tags-dune-image-dans-le-registry-prive","title":"Visualiser les diff\u00e9rents tags d'une image dans le Registry priv\u00e9 :","text":"<p>Pour l\u2019exemple, nous allons rajouter un tag \u201ctest\u201d \u00e0 notre image \u201calpinegit\u201d :</p> <p></p> <p>Voici la commande donc pour visualiser les tags :</p> <p>Visualiser les tag</p> <p>Voici le r\u00e9sultat : </p> <p></p>"},{"location":"Stage_2023_CD_72/Documentation/Registry%20docker/#le-stockage-dans-un-registry-docker","title":"Le stockage dans un Registry Docker :","text":"<p>C\u2019est important d\u2019avoir un stockage car le probl\u00e8me est que si vous quitter votre docker tous seront supprimer, c\u2019est pour cela qui faut cr\u00e9er des volumes.</p> <p>Tout d\u2019abord, il faudra cr\u00e9er un dossier : </p> <p></p> <p>Ensuite lancer un docker avec le param\u00e8tre qui sera pris en compte :</p> <p></p>"},{"location":"Stage_2023_CD_72/Documentation/Registry%20docker/#attention","title":"Attention","text":"<p>Pensez \u00e0 supprimer votre pr\u00e9c\u00e8dent docker</p>"},{"location":"Stage_2023_CD_72/Documentation/Registry%20docker/#le-chiffrement","title":"Le chiffrement :","text":"<p>Tout d\u2019abord, il faudra cr\u00e9er un dossier pour stocker vos certificats :</p> <p></p> <p>Ensuite, il faudra g\u00e9n\u00e9rer vos certificats auto-sign\u00e9e avec l\u2019outil openssl :</p> <p></p> <p>Ensuite cr\u00e9er un docker avec ces param\u00e8tres : </p> <p></p> <p>Et vous pourrais refaire la manip du d\u00e9but c\u2019est-\u00e0-dire tag et push vos images.</p> <p>Pour acc\u00e9der \u00e0 la page pour voir quoi contient votre registry : Lien pour voir ce que contient le registry</p>"},{"location":"Stage_2023_CD_72/Documentation/Registry%20docker/#restriction-dacces","title":"Restriction d'acc\u00e8s :","text":"<p>Il faudra tout d\u2019abord, cr\u00e9er un dossier pour stocker vos fichiers :</p> <p>Ensuite il faudra g\u00e9n\u00e9rer le fichier htpasswd : </p> <p>Ensuite vous pourrez recr\u00e9er un docker avec tous les param\u00e8tres vus depuis le d\u00e9but</p> <p>Ensuite vous vous connectez \u00e0 votre registry avec cette commande : </p> <p>Une fois que vous \u00eates log vous pouvez push vos images :</p> <p>Docker Compose :</p> <p>Normalement, si vous avez tout bien fait vous devriez avoir cette arborescence :</p> <p>Vous pouvez inscrire toutes ces fonctionnalit\u00e9s dans un docker Compose : </p>"},{"location":"Stage_2023_CD_72/Documentation/Script/","title":"Cr\u00e9ation Script pour r\u00e9cup\u00e9rer le volume de la partitions \u201chome\u201d et mettre cette information dans la base de donn\u00e9es MariaDB","text":""},{"location":"Stage_2023_CD_72/Documentation/Script/#exposer-le-port-mariadb","title":"Exposer le port MariaDB :","text":""},{"location":"Stage_2023_CD_72/Documentation/Script/#cest-quoi-un-port","title":"C\u2019est quoi un port ?","text":"<p>Un port est un point virtuel o\u00f9 les connexions r\u00e9seau commencent et se terminent.</p> <p>Tout d\u2019abord, il vous faudra vous rendre sur votre dossier \u201cdocker-compose.yml\u201d.  Il faudra exposer le port \u201c3306\u201d du conteneur MariaDB pour qu\u2019il puisse \u00eatre accessible depuis l\u2019ext\u00e9rieur.</p>"},{"location":"Stage_2023_CD_72/Documentation/Script/#script-sh","title":"Script \u201csh\u201d :","text":""},{"location":"Stage_2023_CD_72/Documentation/Script/#cest-quoi-sh","title":"C\u2019est quoi sh ?","text":"<p>Sh est l'extension utilis\u00e9 pour les scripts shell qui peuvent \u00eatre \u00e9crit en bash, fish, zsh etc.</p> <p>Pour pouvoir connaitre le volume de la partition il vous faut un script ex\u00e9cutable. Il faudra pour cela utiliser l\u2019extension en sh.</p> <p>Tout d\u2019abord, dans votre d\u00e9p\u00f4t local cr\u00e9er un fichier en sh :</p> <pre><code>vim &lt;nom fichier&gt;.sh\n</code></pre> <p>Et mettre ceci dans le fichier :</p> <pre><code>#!/bin/bash\n\n\n# V\u00e9rifier si le client MYSQL est install\u00e9\nif ! type mysql &gt;/dev/null 2&gt;&amp;1; then\n  #Installer le client MySQL\n  sudo apt update\n  sudo apt-get install -y mysql-client\n\nfi\n\n# R\u00e9cup\u00e9rer la taille de la partition\npartition_size=$(du -s /home | awk '{print $1}')\ntimestamp=$(date +%Y-%m-%d\\ %H:%M:%S)\n\n\n\n# Ins\u00e9rer les donn\u00e9es dans la bdd\nmysql -h 127.0.0.1 -P 3306 -u $MYSQL_USER -p$MYSQL_PASSWORD -D $MYSQL_DATABASE -e \"INSERT INTO partition_home (size, timestamp) VALUES ($partition_size,'$timestamp');\"\n\n\n#Charger les variables d'environnement \u00e0 partir du fichier .env\n\nsource .env \n</code></pre>"},{"location":"Stage_2023_CD_72/Documentation/Script/#attention","title":"Attention","text":"<p>Assurer vous que votre script a les permissions d\u2019ex\u00e9cution :</p> <pre><code>\u201dchmod +x &lt;Chemin du script&gt;\u201d\n</code></pre>"},{"location":"Stage_2023_CD_72/Documentation/Script/#crontab","title":"Crontab :","text":""},{"location":"Stage_2023_CD_72/Documentation/Script/#cest-quoi-crontab","title":"C\u2019est quoi \u201ccrontab\u201d ?","text":"<p>Crontab est le nom du programme sous Unix (et Linux) qui permet d'\u00e9diter des tables de configuration du programme cron. Ces tables sp\u00e9cifient les t\u00e2ches \u00e0 ex\u00e9cuter et leur horaire d'ex\u00e9cution.</p> <p>Tout d\u2019abord, il faudra taper la commande crontab \u2013e cela vous ouvrira un fichier.</p> <p>Ensuite en bas il vous faudra indiquer tout les combien de temps un fichier doit s\u2019ex\u00e9cuter : </p> <pre><code>&lt;p\u00e9riode&gt;  &lt;Chemin du fichier&gt;\n</code></pre>"},{"location":"Stage_2023_CD_72/Documentation/Script/#creation-de-la-table-dans-la-base-de-donnees","title":"Cr\u00e9ation de la table dans la base de donn\u00e9es :","text":"<p>Tout d\u2019abord, il faudra vous connecter \u00e0 votre docker :</p> <pre><code>\u201cdocker exec \u2013it &lt;nom du conteneur&gt; /bin/bash\u201d\n</code></pre> <p>Pour cela connecter vous en tant qu'Administrateur de la Base de Donn\u00e9es :</p> <pre><code>\u201cmysql -u root \u2013p\u201d\n</code></pre> <p>Une fois connect\u00e9 \u00e0 la base de donn\u00e9es MariaDB il va falloir indiquer sur quelle base de donn\u00e9es cr\u00e9er la table :</p> <pre><code>\u201cUSE &lt;nom de la base de donn\u00e9es&gt;\u201d\n</code></pre> <p>Une fois la base de donn\u00e9es s\u00e9lectionne vous pouvez cr\u00e9er votre table. Voici un exemple :</p> <pre><code>\u201cCREATE TABLE partitions_home (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  size VARCHAR(20),\n  timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\u201d\n</code></pre> <p>Ensuite pour voir si votre table est cr\u00e9\u00e9e, il vous suffira de faire un :</p> <pre><code>\u201cSHOW TABLES\u201d\n</code></pre> <p>Vous verrez votre table normalement. </p>"},{"location":"Stage_2023_CD_72/Documentation/Script/#voir-si-le-script-fonctionne","title":"Voir si le script fonctionne","text":"<p>Pour voir si le script fonctionne, il vous suffira de faire :</p> <pre><code>\u201cSELECT * FROM &lt;nom de la table cr\u00e9e&gt;\u201d\n</code></pre> <p> Voil\u00e0 vos informations de votre script seront sur votre Base De Donn\u00e9es MariaDB !!</p>"},{"location":"Stage_2023_CD_72/Documentation/gitlab-ci.yml/","title":"Pipelines, CI, CD","text":"<p>Cela va vous permettre en faisant un \"push\" d'une image docker sur votre d\u00e9p\u00f4t elle va se stocker dans votre registry.</p>"},{"location":"Stage_2023_CD_72/Documentation/gitlab-ci.yml/#creation-du-gitlab-ciyml","title":"Cr\u00e9ation du .gitlab-ci.yml","text":"<p>Dans votre d\u00e9pot cr\u00e9er en amont (Revoir GITLAB)</p> <p>Il faudra faire un :</p> <pre><code>\nvim .gitlab-ci.yml\n\n</code></pre> <p>Ensuite il faudra mettre ceci ( Pour l'instant c'est en p\u00e9riode de test ) : </p> <pre><code>\n\nimage: docker:20.10.16\n\nvariables:\n  # When you use the dind service, you must instruct Docker to talk with\n  # the daemon started inside of the service. The daemon is available\n  # with a network connection instead of the default\n  # /var/run/docker.sock socket. Docker 19.03 does this automatically\n  # by setting the DOCKER_HOST in\n  # https://github.com/docker-library/docker/blob/d45051476babc297257df490d22cbd806f1b11e4/19.03/docker-entrypoint.sh#L23-L29\n  #\n  # The 'docker' hostname is the alias of the service container as described at\n  # https://docs.gitlab.com/ee/ci/services/#accessing-the-services.\n  #\n  # Specify to Docker where to create the certificates. Docker\n  # creates them automatically on boot, and creates\n  # `/certs/client` to share between the service and job\n  # container, thanks to volume mount from config.toml\n  DOCKER_TLS_CERTDIR: \"/certs\"\n\nservices:\n  - docker:20.10.16-dind\n\nbefore_script:\n  - docker info\n\nbuild:\n  stage: build\n  tags:\n    - docker\n  before_script:\n    - docker login -u $user -p $mdp https://registry.sarthe.fr:5000\n  script:\n    - docker build -t registry.sarthe.fr:5000/mynginx .\n    #- docker tag mynginx registry.sarthe.fr:5000/mynginx\n    - docker push registry.sarthe.fr:5000/mynginx\n\n</code></pre> <p>Voil\u00e0 votre image sera directement push dans votre registry lors que vous allez push dans votre d\u00e9p\u00f4t</p>"},{"location":"Stage_2023_CD_72/Documentation/gitlab-ci.yml/#creation-des-variable","title":"Cr\u00e9ation des variable","text":"<p>Pour ce faire il faudra vous rendre dans les settings de votre d\u00e9p\u00f4t :</p> <p>Ensuite selectionnez \"CI/CD\" :</p> <p></p> <p>Ensuite descendez jusqu'\u00e0 \"Variables\" et cliquez dessus  :</p> <p></p> <p>Ensuite il faudra remplir les champs suivant :</p> <p></p> <p>KEY: Mettre le nom de la variable souhaiter</p> <p>VALUE: Mettre la valeur correspond a la variable cr\u00e9er avant</p> <p>Ensuite cliquer sur \"ADD VARIABLE\"</p> <p>Voil\u00e0 vos variable cr\u00e9er pour que les gens ne voient pas vos mots de passe ou nom d'utilisateur</p>"},{"location":"Stage_2023_CD_72/Documentation/gitlab-ci.yml/#ajout-de-mkdocs","title":"Ajout de Mkdocs","text":"<p>Cela va permettre d'automatiser en partie le d\u00e9ployment de votre site mkdocs</p> <p>Pour ce faire, il faudra vous rendre sur le fichier \".gitlab-ci.yml\" cr\u00e9er au pr\u00e9alable.</p>"},{"location":"Stage_2023_CD_72/Documentation/gitlab-ci.yml/#fichier-gitlab-ciyml","title":"Fichier .gitlab-ci.yml","text":"<pre><code>\n\n# D\u00e9finition des \u00e9tapes\nstages:\n  - build_mkdocs\n  - build_image\n\n# \u00c9tape 1: G\u00e9n\u00e9ration du site MkDocs\nbuild_mkdocs:\n  stage: build_mkdocs\n  image: python:3.9\n  before_script:\n    - pip install mkdocs\n    - pip install mkdocs-material\n    - pip install mkdocs-mermaid2-plugin\n  script:\n    - mkdocs build --clean \n  artifacts:\n    paths:\n      - site\n\n\n\n\n# \u00c9tape 2: Compilation de l'image Docker\nbuild_image:\n  stage: build_image\n  image: docker:20.10.16\n  variables:\n    DOCKER_TLS_CERTDIR: \"/certs\"\n  services:\n    - docker:20.10.16-dind\n  before_script:\n    - docker info\n  script:\n    - docker login -u $user -p $mdp https://registry.sarthe.fr:5000\n    - docker build -t registry.sarthe.fr:5000/nginx-mkdocs .\n    - docker push registry.sarthe.fr:5000/nginx-mkdocs\n\n  tags:\n    - docker\n\n</code></pre> <p>Ensuite sur votre vm, il faudra faire les manipulations suivantes :</p> <pre><code>\ngit add -A\ngit commit -m &lt;un message&gt;\ngit push\n\n</code></pre> <p>En faisant ceci, sur le gitlab sa va lancer votre script. Une fois votre script effectuer il faudra vous rendre sur votre vm</p> <p>Une fois sur votre vm il faudra arreter votre docker :</p> <pre><code>\ncontrol + c\n\n</code></pre> <p>Ensuite il faudra faire :</p> <pre><code>\nsudo docker pull registry.sarthe.fr:5000/&lt;votre image&gt;\n\n</code></pre> <p>Enfin faite :</p> <pre><code>\nsudo docker run -p 8080:80 registry.sarthe.fr:5000/&lt;votre image&gt;\n\n</code></pre>"},{"location":"Stage_2023_CD_72/Mission/Mission%201/","title":"Le d\u00e9ploiment continue avec docker","text":""},{"location":"Stage_2023_CD_72/Mission/Mission%201/#le-contexte","title":"Le contexte","text":"<p>J'\u00e9tait en stage au sein du service informatique du Conseil d\u00e9partemental du d\u00e9partement de la Sarthe.</p>"},{"location":"Stage_2023_CD_72/Mission/Mission%201/#objectif","title":"Objectif","text":"<p>L'objectif de cette mission \u00e9tait d'explorer et de tester une int\u00e9gration continue pour pouvoir d\u00e9ployer leur application m\u00e9tier.</p>"},{"location":"Stage_2023_CD_72/Mission/Mission%201/#realisation","title":"R\u00e9alisation","text":"<p>Vous pouvez voir comment j'ai r\u00e9aliser ceci gr\u00e2ce \u00e0 ma documentation :</p> <p>Voir dans /StageCD72/Documentation</p> <p>Et aussi j'ai r\u00e9aliser ce sch\u00e9ma pour essayer de mieux comprendre le processus.</p> <p></p>"},{"location":"Stage_2023_CD_72/Mission/Mission%201/#competences-acquises","title":"Comp\u00e9tences acquises","text":"<p>1.4 : Travailler en mode projet</p> <p>1.6 Organiser son d\u00e9veloppement professionnel</p> <p>1.5 Mettre \u00e0 disposition des utilisateurs un service informatique</p>"},{"location":"Stage_2023_CD_72/Mission/Mission%202/","title":"La documentation","text":""},{"location":"Stage_2023_CD_72/Mission/Mission%202/#contexte","title":"Contexte","text":"<p>J'\u00e9tait en stage au sein du service informatique du Conseil d\u00e9partemental du d\u00e9partement de la Sarthe.</p>"},{"location":"Stage_2023_CD_72/Mission/Mission%202/#lobjectif","title":"L'objectif","text":"<p>La documentation est aussi important que la partie technique donc pour le d\u00e9partement il \u00e9tait important de leur laisser une trace pour qu'il l'utilise pour leur futur projet.</p>"},{"location":"Stage_2023_CD_72/Mission/Mission%202/#la-realisation","title":"La r\u00e9alisation","text":"<p>Pour r\u00e9aliser cette doc j'ai detailler \u00e9tapes par \u00e9tapes les t\u00e2ches que j'ai du r\u00e9aliser </p> <p>Vous pouvez allez voir ma documentation dans l'onglet \"Stage CD72 / Documentation\"</p>"},{"location":"Stage_2023_CD_72/Mission/Mission%202/#competences-acquises","title":"Comp\u00e9tences acquises","text":"<p>1.5 Mettre \u00e0 disposition des utilisateurs un service informatique</p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/","title":"Tableau rapport quotidien","text":"<p>RAPPORT QUOTIDIEN</p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/#le-22-mai","title":"Le 22 mai :","text":"<p>Matin : R\u00e9union avec les diff\u00e9rents responsable de chaque services</p> <p>Apr\u00e8s-midi : Recherche sur le docker </p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/#le-23-mai","title":"Le 23 mai","text":"<p>Matin : Installation multipass</p> <p>manipulation VM</p> <p>Install et conf docker </p> <p>Apr\u00e8s-midi : J\u2019ai h\u00e9berger un site web sur un docker qui fait office de serveur web</p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/#preuve","title":"Preuve :","text":"<p>Mission 23/05</p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/#le-24-mai","title":"Le 24 mai","text":"<p>Matin et Apr\u00e8s Midi: </p> <p>Prise en main SSH  Cl\u00e9 prv et pub Git-lab ( Clone et push un d\u00e9p\u00f4t ) </p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/#preuve_1","title":"Preuve :","text":"<p>Mission 24/05</p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/#le-25-mai","title":"Le 25 mai","text":"<p>Matin et Apr\u00e8s Midi: </p> <p>Cr\u00e9ation docker-compose Apache MariaDB avec Wordpress</p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/#preuve_2","title":"Preuve :","text":"<p>Mission 25/05</p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/#le-26-mai","title":"Le 26 mai","text":"<p>Matin et Apr\u00e8s Midi: </p> <p>Cr\u00e9ation d\u2019un script bash qui r\u00e9cup\u00e8re la taille de la partition \u201chome\u201d. Cette information sera stocker dans la BDD</p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/#preuve_3","title":"Preuve :","text":"<p>Mission 26/05</p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/#le-30-mai","title":"Le 30 mai","text":"<p>Matin et Apr\u00e8s Midi</p> <p>Cr\u00e9ation d\u2019un script bash qui r\u00e9cup\u00e8re la taille de la partition \u201chome\u201d. Cette information sera stocker dans la BDD</p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/#preuve_4","title":"Preuve :","text":"<p>Mission 26/05</p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/#le-31-mai","title":"Le 31 mai","text":"<p>Matin et apr\u00e8s midi</p> <p>Utilisation et installation MkDocs</p> <p>H\u00e9bergement Mkdocs sous un docker. Sur le docker tourn\u00e9e le service web Nginx</p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/#preuve_5","title":"Preuve","text":"<p>Mission 31/05</p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/#le-1-juin","title":"Le 1 juin","text":"<p>Customisation page Mdocks </p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/#le-2-juin","title":"Le 2 juin","text":"<p>Visite des serveurs </p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/#le-506","title":"Le 5/06","text":"<p>Installation SRV LINUX DOCKER </p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/#le-606","title":"Le 6/06","text":"<p>Visite d'un coll\u00e8ge + manipulation registry docker </p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/#preuve_6","title":"Preuve","text":"<p>Mission registry</p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/#le-706","title":"Le 7/06","text":"<p>R\u00e9union avec Chef de projet </p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/#le-806","title":"Le 8/06","text":"<p>Journ\u00e9e teletravail</p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/#le-1206","title":"Le 12/06","text":"<p>Push une image sur le registry depuis une VM ext\u00e9rieur </p> <p>Probl\u00e8me : Proxy</p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/#le-1306","title":"Le 13/06","text":"<p>H\u00e9berger et d\u00e9ployer automatiquement mon portfolio sur GITHUB </p> <p>Probl\u00e8me : Proxy</p> <p>Mission GITHUB</p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/#le-1406","title":"Le 14/06","text":"<p>H\u00e9berger et d\u00e9ployer automatiquement mon portfolio sur GITHUB </p> <p>Probl\u00e8me : Proxy</p> <p>Mission GITHUB</p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/#le-1506","title":"Le 15/06","text":"<p>Push image vers registry GITLAB </p> <p>Probl\u00e8me : Proxy</p> <p>Mission push registry GITLAB</p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/#le-1606","title":"Le 16/06","text":"<p>D\u00e9but de r\u00e9daction de la note de synth\u00e8se </p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/#le-1906","title":"Le 19/06","text":"<p>H\u00e9berger et d\u00e9ployer automatiquement mon portfolio sur GITLAB </p> <p>Mission push registry GITLAB</p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/#le-2006","title":"Le 20/06","text":"<p>Visite de mon professeur r\u00e9f\u00e9rent </p>"},{"location":"Stage_2023_CD_72/Rapport%20quotidien/Tableau%20rapport%20quotidien/#le-2106","title":"Le 21/06","text":"<p>Finalisation du projet avec tout qui est automatis\u00e9</p>"},{"location":"Stage_2024_CD72/CD72/","title":"Pr\u00e9sentation de l'organisme","text":""},{"location":"Stage_2024_CD72/CD72/#le-conseil-departemental-de-la-sarthe","title":"LE CONSEIL D\u00c9PARTEMENTAL DE LA SARTHE","text":"<p>Le Conseil D\u00e9partemental est une collectivit\u00e9 territorial qui emploie environ 2500 agents \u00e0 travers tout le d\u00e9partement. Sa finalit\u00e9 est d'assurer le fonctionnement des services d'int\u00e9r\u00eat g\u00e9n\u00e9ral</p> <p>Le Conseil D\u00e9partemental poss\u00e8de des responsabilit\u00e9s nombreuses et diverses : la solidarit\u00e9 (famille, autonomie des personnes, emploi...), le d\u00e9veloppement des territoires (eau, r\u00e9seau \u00e9lectrique, d\u00e9veloppement durable...), la gestion des coll\u00e8ges, la gestion des routes, le sport, le tourisme et la culture.</p> <p>La Direction G\u00e9n\u00e9rale des Services (DGS) est ainsi divis\u00e9e en trois Directions G\u00e9n\u00e9rales Adjointes (DGA) qui se r\u00e9partissent ces missions, et la Direction d\u2019Appui \u00e0 la Performance (DAP) qui occupe un r\u00f4le transverse.</p>"},{"location":"Stage_2024_CD72/CD72/#la-direction-des-systemes-dinformation-et-du-numerique","title":"LA DIRECTION DES SYST\u00c8MES D\u2019INFORMATION ET DU NUM\u00c9RIQUE","text":"<p>La Direction des Syst\u00e8mes d\u2019Information et du Num\u00e9rique (DSIN) fait partie de la DGA Ressources. Son r\u00f4le est expliqu\u00e9 ainsi dans l\u2019annuaire des services :</p> <p>\u201cLa Direction des Syst\u00e8mes d\u2019information et du num\u00e9rique (DSIN) est en charge de la transformation digitale et de la modernisation de l\u2019organisation. Elle assure le pilotage et le d\u00e9veloppement du syst\u00e8me d\u2019information de la collectivit\u00e9, des solutions de t\u00e9l\u00e9communications, la mise en \u0153uvre des nouvelles technologies, ainsi que la promotion des usages num\u00e9riques, \u00e0 titre interne (dans les services) et \u00e0 titre externe (sur le territoire d\u00e9partemental). Elle \u00e9labore et pilote les plans de num\u00e9risation et de renouvellement des syst\u00e8mes d\u2019information, et assure la maintenance et le support sur l\u2019ensemble des solutions num\u00e9riques et en garantit la s\u00e9curisation.\u201d</p> <p>En somme, la DSIN a la charge du parc informatique du Conseil D\u00e9partemental, des syst\u00e8mes et r\u00e9seaux mis \u00e0 disposition des agents et des applications utilis\u00e9es par les divers m\u00e9tiers. Cette responsabilit\u00e9 va de la r\u00e9ponse aux besoins exprim\u00e9s par les agents, jusqu\u2019\u00e0 la maintenance et l\u2019assistance informatique. La DSIN s\u2019occupe \u00e9galement de certains projets relatifs \u00e0 la politique publique du num\u00e9rique.</p> <p>La DSIN comprend plusieurs services, et j\u2019ai pour ma part \u00e9t\u00e9 int\u00e9gr\u00e9e au service Conception &amp; Architecture, dont mon ma\u00eetre de stage est le chef de service.</p> <p>Ce service comprend :</p> <ul> <li> <p>Les architectes (technique et SI/Data)</p> </li> <li> <p>Le responsable s\u00e9curit\u00e9</p> </li> <li> <p>Les admins syst\u00e8mes</p> </li> <li> <p>Le bureau r\u00e9seaux &amp; t\u00e9l\u00e9coms</p> </li> </ul>"},{"location":"Stage_2024_CD72/rapport_quotidien/","title":"Rapport quotidien","text":""},{"location":"Stage_2024_CD72/rapport_quotidien/#8012024","title":"8/01/2024","text":"<ul> <li>Red\u00e9couverte environnement de travail </li> <li>Analyse du besoin qui va s'\u00e9tendre sur la premi\u00e8re semaine </li> <li>Teste de l'outil vagrant </li> </ul>"},{"location":"Stage_2024_CD72/rapport_quotidien/#9012024","title":"9/01/2024","text":"<ul> <li>Utilisation plus appronfondie de vagrant </li> <li>D\u00e9but de la documentation </li> </ul>"},{"location":"Stage_2024_CD72/rapport_quotidien/#problemes","title":"Probl\u00e8mes","text":"<p>Blocage au niveau du proxy qui emp\u00eache la vm d'acc\u00e8der a certains site ou faire des apt-update </p>"},{"location":"Stage_2024_CD72/rapport_quotidien/#10012024","title":"10/01/2024","text":"<ul> <li>Utilisation de vagrant </li> <li>Poursuite  de la documentation </li> </ul>"},{"location":"Stage_2024_CD72/rapport_quotidien/#11012024","title":"11/01/2024","text":"<ul> <li>Utilisation de vagrant </li> <li>Fin de la documentation </li> </ul>"},{"location":"Stage_2024_CD72/rapport_quotidien/#12012024","title":"12/01/2024","text":"<ul> <li>D\u00e9but du projet donn\u00e9 par mon tuteur (D\u00e9ployer automatiquement des Vm sur un hyperviseur avec des provisionneur selon le besoin du CD72)</li> <li>Analyse du besoin (Choix de l'hyperviseur ainsi que du provisionneur)</li> </ul>"},{"location":"Stage_2024_CD72/rapport_quotidien/#13012024","title":"13/01/2024","text":"<ul> <li>Choix de l'hyperviseur qui sera promox </li> <li>Lecture de la documentation promox pour l'installer sur un serveur le 16/01/2024</li> <li>Choix du stockage LVM ou ZFS </li> </ul>"},{"location":"Stage_2024_CD72/rapport_quotidien/#15012024","title":"15/01/2024","text":"<ul> <li>Analyse du besoin (Choix de l'hyperviseur ainsi que du provisionneur)</li> </ul>"},{"location":"Stage_2024_CD72/rapport_quotidien/#16012024","title":"16/01/2024","text":"<ul> <li>Suite a l'analyse de vendredi et lundi on a d\u00e9cid\u00e9 de partir sur l'hyperviseur Proxmox</li> </ul>"},{"location":"Stage_2024_CD72/rapport_quotidien/#17012024","title":"17/01/2024","text":"<ul> <li>Installation en mode test de proxmox sur une veille machine en attendant un serveur de test qui sera mis en place </li> </ul>"},{"location":"Stage_2024_CD72/rapport_quotidien/#18012024","title":"18/01/2024","text":"<ul> <li>Mise en place du serveur avec promox dessus </li> <li>Configuration du stockage ( LVM-Thin ) sur proxmox</li> </ul>"},{"location":"Stage_2024_CD72/rapport_quotidien/#19012024","title":"19/01/2024","text":"<ul> <li>Manipulation du provisionner ( Terraform ) pour d\u00e9ployer les marchines automatiquement sur Proxmox</li> </ul>"},{"location":"Stage_2024_CD72/rapport_quotidien/#22012024","title":"22/01/2024","text":"<p>Poursuite de la manipulation de Terraform. On r\u00e9sous des probl\u00e8me de syntaxe, d'acc\u00e8s erreur par erreur.</p>"},{"location":"Stage_2024_CD72/rapport_quotidien/#23012024","title":"23/01/2024","text":"<p>Poursuite de la manipulation de Terraform. On r\u00e9sous des probl\u00e8me de syntaxe, d'acc\u00e8s erreur par erreur.</p>"},{"location":"Stage_2024_CD72/rapport_quotidien/#24012024","title":"24/01/2024","text":"<p>Message de l'ANSSI re\u00e7u par le d\u00e9partement qu'il y a une fuite des donn\u00e9es qui provienne du portail.sarthe.fr sur des blogs de hacker  Pas de connexion de la journ\u00e9e le temps de r\u00e9soudre le probl\u00e8me</p>"},{"location":"Stage_2024_CD72/rapport_quotidien/#25012024","title":"25/01/2024","text":"<p>A ce jour, j'arrive a d\u00e9ployer une vm avec une configuration de base (Hostname, OS, IP, DNS, SSHKEY, user, password)</p>"},{"location":"Stage_2024_CD72/rapport_quotidien/#26012024","title":"26/01/2024","text":"<p>Etude pour pouvoir combin\u00e9 ansible + terraform. Ansible va servir a installer des services ( Apache, MariaDb) sur la vm lors de l'installation </p>"},{"location":"Stage_2024_CD72/rapport_quotidien/#29012024","title":"29/01/2024","text":"<p>Toujours entrain d'\u00e9tudier ansible </p>"},{"location":"Stage_2024_CD72/rapport_quotidien/#30012024","title":"30/01/2024","text":"<p>Absent en raison de l'entretien pour int\u00e9grer le CESI</p>"},{"location":"Stage_2024_CD72/rapport_quotidien/#31012024","title":"31/01/2024","text":"<p>Toujours entrain d'\u00e9tudier ansible </p> <p>Probl\u00e8me de connexion ssh avec ansible </p>"},{"location":"Stage_2024_CD72/rapport_quotidien/#1022024","title":"1/02/2024","text":"<p>Terraform + ansible marche </p> <p>Probl\u00e8me = ssh-agent </p> <p>Donc j'arrive \u00e0 d\u00e9ployer une vm avec une configuration n\u00e9cessaire ainsi que des services automatiquement</p>"},{"location":"Stage_2024_CD72/rapport_quotidien/#2022024","title":"2/02/2024","text":"<p>R\u00e9alisation du diaporamara pour le 12/02</p> <p>Poursuite de la documentation </p>"},{"location":"Stage_2024_CD72/rapport_quotidien/#5022024","title":"5/02/2024","text":"<p>Essai de d\u00e9ployer 2 vm d'affiler avec l'outil count</p> <p>Probl\u00e9me de syntaxe mais en fin de journ\u00e9e c'\u00e9tait op\u00e9rationnel </p>"},{"location":"Stage_2024_CD72/rapport_quotidien/#6022024","title":"6/02/2024","text":"<p>Etude de l'outil powerdns</p>"},{"location":"Stage_2024_CD72/rapport_quotidien/#7022024","title":"7/02/2024","text":"<p>R\u00e9union pr\u00e9sent\u00e9 par moi-m\u00eame pour faire un point de l'avancement de mon projet avec le service conception </p> <p>Etude de l'outil powerdns</p>"},{"location":"Stage_2024_CD72/rapport_quotidien/#8022024","title":"8/02/2024","text":"<p>D\u00e9couverte SDN (Software-Defined Networking) qui permet de cr\u00e9er des r\u00e9seaux virtuels priv\u00e9 </p> <p>Probl\u00e8me on ne peut pas communiquer avec ce r\u00e9seau avec le r\u00e9seau joinville. Il faut cr\u00e9e des ip routes sur leur routeur pas possible.</p> <p>Donc solution = VPN </p>"},{"location":"Stage_2024_CD72/rapport_quotidien/#9022024","title":"9/02/2024","text":"<p>Abandon de l'outil powerdns </p> <p>Installation d'un serveur opnsense ( DHCP, DNS, NAT et VPN )</p> <p>Configuration DHCP pour le r\u00e9seau priv\u00e9 </p> <p>Reste a faire le DNS, NAT et vpn </p>"},{"location":"Stage_2024_CD72/Documentation/Vagrant/","title":"Le fonctionnement de Vagrant","text":"<p>Vagrant est un logiciel anciennement libre et open-source pour la cr\u00e9ation et la configuration des environnements de d\u00e9veloppement virtuels. Il peut \u00eatre consid\u00e9r\u00e9 comme un wrapper autour de logiciels de virtualisation comme VirtualBox. Depuis la version 1.1, Vagrant n'impose plus VirtualBox, mais fonctionne \u00e9galement avec d'autres logiciels de virtualisation tels que VMware. Depuis la version 1.62 Vagrant prend nativement en charge les  conteneurs Docker \u00e0 l'ex\u00e9cution, au lieu d'un syst\u00e8me d'exploitation enti\u00e8rement virtualis\u00e9. Cela permet de r\u00e9duire la charge en ressources puisque Docker utilise des conteneurs Linux l\u00e9gers.</p>"},{"location":"Stage_2024_CD72/Documentation/Vagrant/#les-box","title":"Les \"box\":","text":"<p>Vagrant utilise des \"box\" qui fonctionne comme un registry, c'esy-\u00e0'dire qu'au lieu de repartir de 0 en recr\u00e9ant une machine de A \u00e0 Z il va chercher dans les diff\u00e9rentes \"box dans le catalogue d'HashiCorp.</p> <p>Fichiers synchronis\u00e9 :  Vagrant synchronise automatiquement les fichiers vers et depuis la machine invit\u00e9e.</p>"},{"location":"Stage_2024_CD72/Documentation/Vagrant/#le-partage-denvironnement","title":"Le partage d'environnement :","text":"<p>Vagrant Share est un plugin qui vous permet de partager l'environnement Vagrant avec n\u2019importe qui autour de la monde entier avec une connexion Internet.  Il vous donnera une URL qui sera achemin\u00e9e directement \u00e0 votre environnement Vagrant \u00e0 partir de n\u2019importe quel appareil dans le monde connect\u00e9 \u00e0 Internet.</p>"},{"location":"Stage_2024_CD72/Documentation/Vagrant/#les-providers","title":"Les providers","text":"<p>Un provider est l'emplacement dans lequel l'environnement virtuel s'ex\u00e9cute. Il peut \u00eatre local (la valeur par d\u00e9faut est d'utiliser VirtualBox) ou distant.</p>"},{"location":"Stage_2024_CD72/Documentation/Vagrant/#les-provisions-aprovisionement","title":"Les provisions / Aprovisionement","text":"<p>Un approvisionneur est un outil pour configurer l'environnement virtuel. Il peut \u00eatre aussi simple qu'un script shell, mais en variante, un outil plus avanc\u00e9 comme Chef, Puppet ou Ansible peut \u00eatre utilis\u00e9.</p> <p>Les approvisionneurs de Vagrant vous permettent d'installer automatiquement des logiciels, de modifier les configurations et plus encore sur la machine dans le processus de d\u00e9marrage.</p>"},{"location":"Stage_2024_CD72/Documentation/Vagrant/#prerequis","title":"Pr\u00e9requis","text":"<p>Pour utiliser vagrant, il faut avoir des moyens de virtualisations sur son PC tel que : </p> <ul> <li>HyperV</li> <li>VirtualBox</li> <li>Docker</li> </ul>"},{"location":"Stage_2024_CD72/Documentation/Vagrant/#activer-hyperv-en-commande-powershell","title":"Activer HyperV en commande powershell","text":"<pre><code>nable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V -All\n</code></pre>"},{"location":"Stage_2024_CD72/Documentation/Vagrant/#installation-de-vagrant","title":"Installation de Vagrant","text":"<p>Tout d'abord, il faudra vous rendre sur le site de vagrant</p> <p>Il faudra choisir le packages correspondant a votre syst\u00e8me d'exploitation (MacOs,Windows,Linux)</p> <p></p> <p>Plus qu'a t\u00e9l\u00e9charger !! </p>"},{"location":"Stage_2024_CD72/Documentation/Vagrant/#cree-son-environemment","title":"Cr\u00e9e son environemment","text":"<p>Tout d'abord cr\u00e9\u00e9 un dossier dans l'emplacement de votre choix </p> <p>Ensuite il vous faudra ouvrir un invite de commande et se positionner sur le dossier cr\u00e9e </p> <p>Une fois cela fait il faudra fait la commande suivante : </p> <pre><code>\nvagrant init \n\n</code></pre> <p>Cette commande va ainsi vous cr\u00e9er un fichier VagrantFile qui va vous permettre de g\u00e9nerer et g\u00e9rer vos vm dans votre environnement </p>"},{"location":"Stage_2024_CD72/Documentation/Vagrant/#le-fichier-vagrantfile","title":"Le fichier Vagrantfile","text":"<p>Ce fichier va vous permettre de configurer votre environnement </p> <p>Ceci est un exemple de fichier que j'ai pu r\u00e9aliser :</p> <pre><code># -*- mode: ruby -*-\n# vi: set ft=ruby :\n\nrequire 'yaml'\n\n# Chargez les informations depuis le fichier config.yml\nconfig_data = YAML.load_file('config.yml')\n\nVagrant.configure(\"2\") do |config|\n  config.vm.box = \"generic/ubuntu2204\"\n\n\n\n  config.vm.define 'srv-test' do |node|\n    node.vm.hostname = 'srv-test'\n  end\n\n\n    # Sp\u00e9cifie le fournisseur pour la machine virtuelle (Hyper-V)\n    config.vm.provider \"hyperv\" do |h|\n      h.vmname = \"srv-test\"\n      h.enable_virtualization_extensions = true\n      h.linked_clone = true\n\n    end\n\n    # Configuration du proxy pour l'environnement\n    config.proxy.http     = \"http://172.16.20.90:8080\"\n    config.proxy.https    = \"http://172.16.20.90:8080\"\n    config.proxy.no_proxy = \"localhost,127.0.0.1\"\n\n    # Provisionnement en utilisant un script shell directement dans le Vagrantfile\n    config.vm.provision \"shell\", inline: &lt;&lt;-SHELL\n      echo \"nameserver 172.16.20.160\" | sudo tee /etc/resolv.conf\n      echo \"nameserver 172.16.20.18\" | sudo tee -a /etc/resolv.conf\n    SHELL\n\n    # Script d'installation d'Ansible\n    config.vm.provision \"shell\", inline: &lt;&lt;-SHELL\n\n      # Mise \u00e0 jour de la liste des d\u00e9p\u00f4ts APT\n      sudo apt update\n\n      # Installation de software-properties-common pour g\u00e9rer les d\u00e9p\u00f4ts\n      sudo apt install -y software-properties-common\n\n      # Ajout du repository Ansible\n      sudo apt-add-repository --yes --update ppa:ansible/ansible\n\n      # Installation d'Ansible\n      sudo apt install -y ansible\n    SHELL\n\nend\n\n\n</code></pre>"},{"location":"Stage_2024_CD72/Documentation/Vagrant/#quelques-manipulations-avant-de-lancer-votre-fichier-si-besoin","title":"Quelques manipulations avant de lancer votre fichier si besoin !","text":""},{"location":"Stage_2024_CD72/Documentation/Vagrant/#configuration-proxy","title":"Configuration Proxy","text":"<p>Le proxy risque de vous pose probl\u00e8mes pour aller chercher des box, ou faire des apt-update etc...</p> <p>C'est pour cela qui faudra effectuer quelques commandes avant de lancer votre environnement :</p> <p>Tout d'abord il faudra que vous ouvrez un cmd en admin</p> <p>et ensuite faire c'est trois commandes :</p> <pre><code>\nset http_proxy=ADRESSE PROXY\n\nset https_proxy=ADRESSE PROXY\n\nvagrant plugin install vagrant-proxyconf\n\n</code></pre> <p>Si vous voyez ceci s'afficher c'est que c'est bon !!</p>"},{"location":"Stage_2024_CD72/Documentation/Vagrant/#conf-fichieryml","title":"Conf fichier.yml","text":"<p>Comme vous le voyez il y a des variables pour le partage de fichier ceci permet a vagrant d'acc\u00e8der a nos fichiers sauf qu'il faut mettre notre login P@ssword en clair ce qui n'est pas une bonne pratiques. C'est pour cela qui vous faudra cr\u00e9e des variables ainsi que ce fichier </p> <p>Il faudra cr\u00e9er un fichier yml dans votre dossier d'environnement </p> <p>Voici la configuration : </p> <pre><code>\n# config.yml\nsmb_username: \"votre User\"\nsmb_password: \"Votre P@ssword\"\n\n</code></pre> <p>Ainsi le fichier Vagrantfile ira chercher les valeurs des variables qu'on lui a mis pour la partage de fichier</p>"},{"location":"Stage_2024_CD72/Documentation/Vagrant/#lancement-de-votre-environnement","title":"Lancement de votre environnement","text":"<p>Quand tout cela est effectu\u00e9 vous pourrez lancer votre environnement</p> <p>Il faudra bien sur \u00eatre encore positionner dans le dossier cr\u00e9e auparavant </p> <p>Pour cela il vous faudra utlis\u00e9 cette commande </p> <pre><code>\nvagrant up \n\n</code></pre> <p>Si vous avez des scripts dans votre VagrantFile utilis\u00e9 plut\u00f4t cette commande : </p> <pre><code>\nvagrant up --provision \n\n</code></pre> <p>Une fois cette commande effectu\u00e9 vous devrez attendre que le fichier g\u00e9n\u00e9re la vm.</p> <p>Ensuite aller dans votre outil de virtualisation utilis\u00e9 et si tout ce passe bien vous devriez apercevoir votre machine.</p>"},{"location":"Stage_2024_CD72/Documentation/Vagrant/#connecter-la-vm-en-ssh-sur-vscode","title":"Connecter la VM en ssh sur Vscode","text":"<p>Pour cela ouvrez un invite de commande et placer vous dans dossier d'environnement </p> <p>Ensuite faite cette commande : </p> <pre><code>\nvagrant ssh-config \n\n</code></pre> <p>Vous aurez ceci : </p> <p>Ensuite allez sur Vscode et installer l'extension Remote Development</p> <p></p> <p>Une fois installer vous aurez cette petite ic\u00f4ne apparaitre en bas a gauche de votre \u00e9cran</p> <p></p> <p>Cliquez dessus et selectionner Connect To Host</p> <p>Ensuite cliquez sur Configure SSH Hosts</p> <p>Ensuite cliquer sur votre fichier ssh-config</p> <p>Puis copier toutes les informations que vous avez r\u00e9colt\u00e9 en faisant la commande sur le fichier </p> <pre><code>\nvagrant ssh-config \n\n</code></pre> <p>Sa devrait vous donner ceci : </p> <p></p> <p>Important sur la ligne Hostname remplacer l'ip par le nom de votre machine !!!!</p> <p>Une fois fini Cliquez sur l'ic\u00f4ne remote et selectionner Connect To Host</p> <p>Ensuite vous verrez le nom de votre machine, cliquez dessus et vous serrez connect\u00e9 en ssh sur votre vm.</p>"},{"location":"Stage_2024_CD72/Documentation/Vagrant/#installer-des-paquets-automatiquement","title":"Installer des paquets automatiquement","text":"<p>Prenons l'exemple du paquet ansible </p> <p>Il faudra rajouter ceci dans votre VagrantFile :</p> <pre><code>\n # Script d'installation d'Ansible\n    config.vm.provision \"shell\", inline: &lt;&lt;-SHELL\n\n      # Mise \u00e0 jour de la liste des d\u00e9p\u00f4ts APT\n      sudo apt update\n\n      # Installation de software-properties-common pour g\u00e9rer les d\u00e9p\u00f4ts\n      sudo apt install -y software-properties-common\n\n      # Ajout du repository Ansible\n      sudo apt-add-repository --yes --update ppa:ansible/ansible\n\n      # Installation d'Ansible\n      sudo apt install -y ansible\n    SHELL\n\n</code></pre> <p>Si vous avez d\u00e9ja une vm faites la commande : </p> <pre><code>\nvagrant reload --provision \n\n</code></pre> <p>Si c'est votre premier lancement faites : </p> <pre><code>\nvagrant up --provision \n\n</code></pre> <p>Pour v\u00e9rifier que le script fonctionne connecter sur votre vm et faites :</p> <pre><code>\nansible --version \n\n</code></pre>"},{"location":"Stage_2024_CD72/Documentation/Vagrant/#les-commandes-utiles","title":"Les commandes utiles","text":"<p>vagrant init : cr\u00e9e un fichier Vagrantfile dans le r\u00e9pertoire courant. Ce fichier contient la configuration de la Vagrant Box \u00e0 utiliser. Tu peux utiliser cette commande pour cr\u00e9er un nouveau projet Vagrant.</p> <p>vagrant up : d\u00e9marre la Vagrant Box. Si la box n\u2019est pas encore install\u00e9e, Vagrant la t\u00e9l\u00e9chargera et la configura avant de la d\u00e9marrer.</p> <p>vagrant ssh: se connecte \u00e0 la Vagrant Box en utilisant SSH. Tu peux utiliser cette commande pour acc\u00e9der \u00e0 la console de la box et ex\u00e9cuter des commandes sur le syst\u00e8me d\u2019exploitation de la box.</p> <p>vagrant halt : arr\u00eate la Vagrant Box. Tu peux utiliser cette commande pour mettre la box en pause ou pour l\u2019arr\u00eater compl\u00e8tement.</p> <p>vagrant destroy : supprime la Vagrant Box. Cette commande arr\u00eate la box et la supprime de ta machine. Tu peux utiliser cette commande pour nettoyer ton environnement de d\u00e9veloppement</p> <p>Vagrant reload : red\u00e9marrer l'environnement </p> <p>vagrant ssh-config : acc\u00e8der a la conf ssh de la vm </p> <p>vagrant up --provision : lancer les scripts mis dans le vagrantfile au lancement de la vm</p>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/Proxmox/Creation_template/","title":"Pourquoi cr\u00e9er des templates","text":"<p>Il vous faut cr\u00e9e des templates dans prmox car l'outil cloud-init est compatible qu'en faisant des clones c'est pour cela qu'il faudra cr\u00e9er des templates</p>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/Proxmox/Creation_template/#installer-images-cloud","title":"Installer images cloud","text":"<p>Ceci ce fait avec quelques lignes de commandes : </p> <p>Tout d'abord il faudra vous connecter en ssh sur votre serveur proxmox</p> <p>Ensuite il faudra t\u00e9l\u00e9charger une image cloud de votre disbutrion de votre choix </p> <p>Il faudra prendre la version de votre choix </p> <p>Il faudra prendre en .img ou qcow2</p> <p>exemple : lien cloud ubuntu         : Lien cloud debian </p>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/Proxmox/Creation_template/#notes","title":"Notes","text":"<p>Si vous \u00eates en root enlever le sudo </p> <p>Pour l'installer faites un wget + le lien de l'image cloud</p> <pre><code>\nwget https://cloud-images.ubuntu.com/jammy/current/jammy-server-cloudimg-amd64.img\n\n</code></pre> <p>Ensuite il faudra installer une bliblioth\u00e8que pour l'agent :</p> <pre><code>\nsudo apt install guestfs-tools\n\n</code></pre> <p>Une fois installer il faudra installer le qemu-guest-agent pour cela faites : </p> <pre><code>\nvirt-customize -a \"nom_de_l'image\" --install qemu-guest-agent\n\n</code></pre> <p>Il est aussi possible de r\u00e9duire votre disque o\u00f9 se trouvera l'image je conseille fortement 5G au minimum </p> <pre><code>\nqemu-img resize --shrink \"nom de l'image\" 5G\n\n</code></pre> <p>Il est temps de cr\u00e9er votre template.</p>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/Proxmox/Creation_template/#creation-de-la-template","title":"Cr\u00e9ation de la template","text":"<p>Pour cela faites : </p> <pre><code>\n9000 = ID de la machine \n\nnet 0 virtio,bridge=vmbr0 = interface r\u00e9seau\n\nname = le nom de la machine \n\nmemory = la m\u00e9moire \n\nsudo qm create 9000 --name \"nom_de_votre_vm\" --memory 2048 --cores 2 --net0 virtio,bridge=vmbr0\n\n</code></pre> <p>Ensuite vous devrez importer un disque sur votre stockage :</p> <pre><code>\nsudo qm importdisk 9000 \"nom_de_l'image\" pve-data\n\n</code></pre> <p>Ensuite, il faudra attacher le disque a la vm comme disque virtio</p> <pre><code>\nsudo qm set 9000 --virtio0 pve-data:vm-9000-disk-0\n\n</code></pre> <p>Ajout d'un disque de type cloud-init : </p> <pre><code>\nsudo qm set 9000 --ide2 pve-data:cloudinit\n\n</code></pre> <p>Ensuite faudra indiquer a la template le boot :</p> <pre><code>\nsudo qm set 9000 --boot c --bootdisk virtio0\n</code></pre> <p>Ensuite pour \u00e9viter d'avoir un \u00e9cran noir sur la template il faut faire cette commande :</p> <pre><code>\nsudo qm set 9000 --serial0 socket --vga serial0\n\n</code></pre> <p>Ensuite il faudra activ\u00e9 l'agent </p> <pre><code>\nsudo qm set 9000 --agent enabled=1\n\n</code></pre> <p>Pour finir il vous suffira de la convertir en template</p> <pre><code>\nsudo qm template 9000\n\n</code></pre>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/Proxmox/Creation_template/#configuration-cloud-init-dans-proxmox","title":"Configuration Cloud-init dans Proxmox :","text":"<p>Il faudra renseigner un user et password </p> <p>Ensuite mettre votre nom de domaine ainsi que votre dns </p> <p>Et enfin ssi vous voulez vous connecter en ssh renseignez votre cl\u00e9 ssh</p>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/Proxmox/Creation_template/#attention","title":"Attention","text":"<ul> <li>N'oubliez pas si vous avez plusieurs template mettre un ID diff\u00e9rent  </li> </ul>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/Proxmox/Gestion_du_stockage/","title":"Le stockage sur Proxmox","text":"<p>Pour commencer par d\u00e9faut \u00e0 l'installation Proxmox va cr\u00e9er 3 partition en lvm qui sont :</p> <p></p>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/Proxmox/Gestion_du_stockage/#stockage-vm","title":"Stockage VM","text":"<p>Il est important de cr\u00e9er un disque diff\u00e9rent pour le stockage de VM pour cela je vous conseille de partir sur du lvm-thin.</p>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/Proxmox/Gestion_du_stockage/#pourquoi-lvm-thin","title":"Pourquoi LVM-THIN","text":"<p>Je vous conseille lvm-thin par rapport a lvm tout simplement var lvm ne prend pas les snapchots en compte ce qui peut \u00eatre tr\u00e8s compliqu\u00e9 en cas de panne de votre vm si vous ne pouvez pas revenir en arri\u00e8re alors que lvm-thin permet ceci.</p>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/Proxmox/Gestion_du_stockage/#creation-stockage-lvm-thin","title":"Cr\u00e9ation stockage lvm-thin","text":"<p>Tout d'abord rendez-vous sur votre proxmox : http://ip_de_votre_machine:8006</p> <p>Ensuite connectez vous avec votre compte root : </p> <p></p> <p>Ensuite une fois connect\u00e9 cliquez sur votre serveur : </p> <p></p> <p>Ensuite allez sur l'onglet disques puis lvm-thin</p> <p></p> <p>Ensuite cliquez sur Create:thinpool</p> <p></p> <p>Vous aurez cette fen\u00eatre apparaitre : </p> <p></p> <ul> <li>Il vous proposera un disque qui n'est pas utilis\u00e9</li> <li>Il faudra lui donn\u00e9 un nom </li> <li>Il vous suffira de appuyer sur cr\u00e9e</li> </ul>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/Proxmox/Gestion_du_stockage/#resultat","title":"R\u00e9sultat","text":"<p>Une fois l'op\u00e9ration vous pourrez voir le thinpool cr\u00e9e </p> <p></p> <p>Vous pouvez le voir aussi en ligne de commande en faisant la commande suivante : </p> <pre><code>\nlsblk\n\n</code></pre> <p></p>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/Proxmox/Gestion_du_stockage/#pourquoi-faire-un-pool","title":"Pourquoi faire un pool","text":"<p>Le pool va vous permettre de mieux organiser le stockage de vos VMs</p>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/Proxmox/Gestion_du_stockage/#creation-du-pool","title":"Cr\u00e9ation du pool","text":"<p>Tout d'abord rendez-vous sur votre proxmox : http://ip_de_votre_machine:8006</p> <p>Ensuite connectez vous avec votre compte root : </p> <p></p> <p>Ensuite, il faut se rendre sur l'onglet pool</p> <p></p> <p>Une fois sur cette onglet ilo faudra appuyer sur cr\u00e9e</p> <p></p> <p>Vous aurez cette fen\u00eatre apparaitre : </p> <p></p> <ul> <li>Il faudra lui renseigner un nom </li> <li>Mettre un commentaire </li> </ul> <p>Ensuite appuyer sur ok</p>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/Proxmox/Gestion_du_stockage/#resultat_1","title":"R\u00e9sultat","text":"<p>Une fois cela fait vous verrez apparaitre votre pool a 2 endroits : </p> <ul> <li>Dans l'onglet pool </li> </ul> <p></p> <ul> <li>Sur l'onglet g\u00e9n\u00e9ral \u00e0 votre gauche </li> </ul> <p></p>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/Proxmox/installation_proxmox/","title":"Installation Proxmox VE 8.1","text":"<p>Pour cette documentation je me suis inspir\u00e9 de la documentation fournie par Proxmox</p>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/Proxmox/installation_proxmox/#configuration-requises","title":"Configuration requises","text":"<ul> <li> <p>Intel EMT64 ou AMD64 avec indicateur CPU Intel VT/AMD-V.</p> </li> <li> <p>M\u00e9moire : minimum 2 Go pour le syst\u00e8me d'exploitation et les services Proxmox VE, plus la m\u00e9moire d\u00e9sign\u00e9e pour les invit\u00e9s. Pour Ceph et ZFS, une m\u00e9moire suppl\u00e9mentaire est requise ; environ 1 Go de m\u00e9moire pour chaque To de stockage utilis\u00e9.</p> </li> <li> <p>Stockage rapide et redondant, les meilleurs r\u00e9sultats sont obtenus avec les SSD.</p> </li> <li> <p>Stockage du syst\u00e8me d'exploitation : utilisez un RAID mat\u00e9riel avec cache en \u00e9criture prot\u00e9g\u00e9 par batterie (\u00ab BBU \u00bb) ou non-RAID avec ZFS (SSD en option pour ZIL).</p> </li> </ul>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/Proxmox/installation_proxmox/#stockage-de-la-vm","title":"Stockage de la VM :","text":"<ul> <li> <p>Pour le stockage local, utilisez soit un RAID mat\u00e9riel avec cache d'\u00e9criture sauvegard\u00e9 par batterie (BBU), soit un non-RAID pour ZFS et Ceph. Ni ZFS ni Ceph ne sont compatibles avec un contr\u00f4leur RAID mat\u00e9riel.</p> </li> <li> <p>Le stockage partag\u00e9 et distribu\u00e9 est possible.</p> </li> <li> <p>Cartes r\u00e9seau (multi) Gbit redondantes, avec cartes r\u00e9seau suppl\u00e9mentaires en fonction de la technologie de stockage pr\u00e9f\u00e9r\u00e9e et de la configuration du cluster.</p> </li> <li> <p>Pour le relais PCI(e), le processeur doit prendre en charge l'indicateur VT-d/AMD-d.</p> </li> </ul>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/Proxmox/installation_proxmox/#attention","title":"Attention","text":"<p>Il faudra penser a activer la virtualisation dans votre BIOS/UEFI</p> <p>Liste touche bios</p> <p>Ce param\u00e8tre d\u00e9pendra de votre bios </p>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/Proxmox/installation_proxmox/#console-dinstallation-proxmox","title":"Console d'installation Proxmox","text":"<p>Tout d'abord il faudra vous rendre sur le site proxmox et installer l'iso proxmox site iso proxmox</p> <p>Une fois que l'iso sera boot sur votr machine via diff\u00e9rent syst\u00e8me (Idrac, cl\u00e9 bootable...), il vous sera affich\u00e9 ceci : </p> <p></p> <p>Pour plus de confort selectionner le mode console </p> <p>Ensuite il vous faudra accepter le contrat de licence : </p> <p></p> <p>Il faudra ensuite cliquer sur I agree</p>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/Proxmox/installation_proxmox/#configuration-stockage","title":"Configuration stockage","text":"<p>Ensuite, vous allez arriver sur cette page </p> <p></p> <p>Vous allez avoir 2 options qui s'offre \u00e0 vous :</p> <ul> <li> <p>1\u00e8re option : Vous ne voulez pas de redondance donc vous utilisez qu'un seul disque mais le risque est que si votre disque tombe vous ne pourrez plus acc\u00e9der a proxmox et n'y r\u00e9cup\u00e9rer c'est donner ( Donc utliser de pr\u00e9f\u00e9rence un disque plus petit pour le syst\u00e8me ).</p> </li> <li> <p>2\u00e8me option : Vous voulez faire une backup ou de la redondance il sera pr\u00e9f\u00e9rable d'utliser ZFS qui correspond a diff\u00e9rents types de RAID.</p> </li> </ul> <p>Choissisez l'option qui correspond \u00e0 vos besoins.</p>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/Proxmox/installation_proxmox/#configuration-country","title":"Configuration Country","text":"<p>Il faudra juste choisir dans quel pays vous r\u00e9sidez pour le fuseau horaire et la langue.</p>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/Proxmox/installation_proxmox/#creation-compte-root","title":"Cr\u00e9ation compte root","text":"<p>Il faudra renseignez un mot de passe fort et votre adresse mail pour \u00eatre prevenu en cas de souci avec proxmox.</p>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/Proxmox/installation_proxmox/#configuration-reseaux","title":"Configuration r\u00e9seaux","text":"<p>Pour la configuration r\u00e9seaux vous aurez ceci :</p> <p></p> <p>Il vous suffira de selectionner votre bonne carte r\u00e9seau ainsi que le nom de votre serveur proxmox et ses param\u00e8tres IP </p>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/Proxmox/installation_proxmox/#recap-de-linstallation","title":"Recap de l'installation","text":"<p>Voici le recap de votre installation </p> <p>Ensuite, une fois que vous avez bien v\u00e9rifier votre r\u00e9capitulatif vous pouvez lancer votre installation en cliquant sur Install</p>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/Proxmox/installation_proxmox/#installation-proxmox","title":"Installation Proxmox","text":"<p>Une fois que vous allez appuyer sur Install vous verrez cette fen\u00eatre :</p> <p></p> <p>Proxmox est entrain de s'installer sur votre machine cela prendra quelques minutes</p>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/Proxmox/installation_proxmox/#fin-dinstallation","title":"Fin d'installation","text":"<p>Une fois votre proxmox installer vous verrez cette f\u00eanetre apparaitre : </p> <p></p> <p>Ceci sera votre url pour acc\u00e8der pour acc\u00e8der \u00e0 l'interface de proxmox sur un navigateur web (Firefox, Chrome)</p>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/Proxmox/installation_proxmox/#se-connecter-sur-linterface-web-proxmox","title":"Se connecter sur l'interface Web proxmox","text":"<p>Rentrez l'url qui vous avez \u00e9tait donner lors de votre installation : \"http://ip_machine:8086\"</p> <p>Une fois cela rentrer vous verrez ceci : </p> <p></p>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/ansible/conf_ansible/","title":"Utilsation de Ansible pour installer des services sur la vm","text":"<p>Tout d'abord cr\u00e9er un dossier ansible </p> <pre><code>\nmkdir ansible\n\n</code></pre> <p>Il faudra cr\u00e9er un dossier task o\u00f9 il y aura votre playbook</p> <pre><code>\nmkdir task\n\n</code></pre> <p>Il faudra cr\u00e9er un dossier template on vous y mettrez vos template </p> <pre><code>\nmkdir template\n\n</code></pre> <p>Ensuite dans ce dossier il faudra cr\u00e9er un playbook dans lequel vous allez d\u00e9finire les t\u00e2ches \u00e0 r\u00e9aliser </p> <pre><code>\n- name: Configure Proxy and Timezone, Update Packages, Install and Start Apache\n  hosts: all\n  become: yes  # Autoriser l'ex\u00e9cution des t\u00e2ches en tant que superutilisateur\n\n  tasks:\n\n    - name: COPY SET PROXY CONF\n      become: yes  # Ex\u00e9cuter cette t\u00e2che en tant que superutilisateur\n      ansible.builtin.template:  # Utilisation du module template pour copier un fichier template\n        src: /home/anto/automatisation/ansible/90curtin-aptproxy.j2\n        dest: '/etc/apt/apt.conf.d/90curtin-aptproxy'  # Destination du fichier g\u00e9n\u00e9r\u00e9\n        owner: root  # Propri\u00e9taire du fichier\n        group: root  # Groupe du fichier\n        mode: '0644'  # Permissions du fichier\n\n\n    - name: Configure proxy in /etc/environment for HTTP\n      lineinfile:  # Utilisation du module lineinfile pour g\u00e9rer les lignes dans un fichier texte\n        path: /etc/environment  # Chemin du fichier\n        regexp: '^http_proxy='  # Expression r\u00e9guli\u00e8re pour rechercher une ligne\n        line: 'http_proxy=proxy'  # Ligne \u00e0 ajouter ou modifier\n        state: present  # \u00c9tat de la ligne (pr\u00e9sent dans ce cas)\n\n\n    - name: Configure proxy in /etc/environment for HTTPS\n      lineinfile:  # Utilisation du module lineinfile pour g\u00e9rer les lignes dans un fichier texte\n        path: /etc/environment  # Chemin du fichier\n        regexp: '^https_proxy='  # Expression r\u00e9guli\u00e8re pour rechercher une ligne\n        line: 'https_proxy=proxy'  # Ligne \u00e0 ajouter ou modifier\n        state: present  # \u00c9tat de la ligne (pr\u00e9sent dans ce cas)\n\n\n    - name: Set timezone\n      timezone:  # Utilisation du module timezone pour configurer le fuseau horaire\n        name: \"Europe/Paris\"  # Nom du fuseau horaire \u00e0 configurer\n\n\n    - name: Update packages\n      apt:  # Utilisation du module apt pour g\u00e9rer les packages sous Debian/Ubuntu\n        update_cache: yes  # Mise \u00e0 jour de la cache des paquets\n        upgrade: yes  # Mise \u00e0 jour des packages install\u00e9s\n\n\n    - name: Install Apache web server\n      apt:  # Utilisation du module apt pour g\u00e9rer les packages sous Debian/Ubuntu\n        name: apache2  # Nom du package \u00e0 installer\n        state: present  # \u00c9tat souhait\u00e9 du package (pr\u00e9sent dans ce cas)\n\n    - name: Ensure Apache service is started and enabled\n      service:  # Utilisation du module service pour g\u00e9rer les services syst\u00e8me\n        name: apache2  # Nom du service \u00e0 g\u00e9rer (Apache dans ce cas)\n        state: started  # \u00c9tat souhait\u00e9 du service (d\u00e9marr\u00e9 dans ce cas)\n        enabled: yes  # Activer le service au d\u00e9marrage du syst\u00e8me\n\n</code></pre> <p>Ensuite pour indiquer le proxy, il faudra cr\u00e9er un template comme indiquer dans le code. Dans ce fichier vous allez indiquer l'addresse de votre proxy : </p> <pre><code>\nAcquire::http::Proxy \"{{ http_proxy }}\";\nAcquire::https::Proxy \"{{ https_proxy }}\";\n\n</code></pre> <p>Enfin dans votre fichier main.tf il faudra renseigner cette ligne :</p> <pre><code>\n # Commande \u00e0 ex\u00e9cuter apr\u00e8s le d\u00e9ploiement de la machine virtuelle\n    command = \"sleep 1m &amp;&amp; ANSIBLE_HOST_KEY_CHECKING=False ansible-playbook -i '172.16.100.6,' -u root   /home/anto/automatisation/ansible/setup_vm.yml\"\n\n</code></pre> <p>Elle va permettre d'executer l'ansible sur la vm provisionn\u00e9e automatiquement.</p> <p>Une fois les fichiers dont a besoin terraform et ansible sont cr\u00e9e allez sur votre machine est aller sur votre dossier terraform.</p> <p>Une fois cela fait vous aurez 5 commandes a effectuer :</p> <ul> <li>Les deux premi\u00e8res commandes va servir a renseigner la cl\u00e9 ssh parce que ansible ne peut pas la renseign\u00e9 tout seul</li> </ul> <pre><code>\nssh-agent $SHELL\n\nssh-add \n</code></pre>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/terraform/Conf.terraform/","title":"Cr\u00e9ation des fichier terraform","text":"<p>Tout d'abord cr\u00e9er un fichier automatisation dans lequel vous mettrez un dossier ansible et terraform. Concentrons-nous sur le dossier terraform vous devrez cr\u00e9er 3 dossiers :</p> <ul> <li>credential.auto.tvars ( Pour les infos sensible )</li> <li>providers.tf ( Pour que terraform acc\u00e8de \u00e0 proxmox )</li> <li>main.tf (Le fichier qui va cloner et configurer votre vm)</li> <li>variable.tf ( Le fichier pour d\u00e9clarer vos variables)</li> <li>D'un dossier modules</li> </ul> <p>Cr\u00e9er vos fichier sur vscode se sera plus pratique</p> <p>lien connection ssh</p> <p>Ce lien vous explique comment connecter votre machine en ssh sur vscode</p> <p>Ensuite vous aller cr\u00e9er un premier fichier confidentiel qui va permettre de stocker le lien de votre proxmox ainsi que les informations de votre API TOKEN</p> <p>Pour cela nommez ce fichier \"credentials.auto.tfvars\"</p> <pre><code>\nproxmox_api_url = \"http://ip_de_votre_machine:8006/api2/json\"\nproxmox_api_token_id = \"Votre ID jeton\"\nproxmox_api_token_secret = \"Votre sercret\"\n\n</code></pre> <p>Une fois cela fait faites contol+s</p> <p>Ensuite cr\u00e9er un fichier provider.tf : </p> <p>Il faudra mettre ces informations : </p> <pre><code>\n# Configuration de Terraform et sp\u00e9cification des versions des fournisseurs requis\nterraform { \n  required_providers {\n    proxmox = {\n      source  = \"TheGameProfi/proxmox\"\n      version = \"2.9.16\"\n    }\n  }\n}\n\n\n# Fournisseur Proxmox avec les d\u00e9tails d'authentification\nprovider \"proxmox\" {\n  pm_api_url           = var.proxmox_api_url\n  pm_api_token_id      = var.proxmox_api_token_id\n  pm_api_token_secret  = var.proxmox_api_token_secret\n  pm_tls_insecure      = true    # D\u00e9sactive la v\u00e9rification TLS pour les connexions (utilis\u00e9 dans les environnements de test)\n  pm_debug             = true    # Active le mode d\u00e9bogage pour le fournisseur Proxmox\n}\n</code></pre> <p>Ce fichier va permettre a terraform de joindre l'api de proxmox</p> <p>Puis, il faudra cr\u00e9er un dernier fichier qui va permettre de configurer votre vm </p> <p>Il s'appelera g\u00e9n\u00e9ralement main.tf</p> <p>Voici ce qu'on peut retrouver dans ce fichier </p> <pre><code>\n\nmodule \"serveurs-vm\" {\n    source = \"./modules/serveurs-vm\" #nom du module \n    count = 1 # Nombre de vm cr\u00e9e \n    vm_ip = \"172.16.99.${count.index + 2}\" # Variable qui change par rapport au main du module \n    vm_name=\"srv-anto-${count.index + 2}\" # Variable qui change  par rapport au main du module \n\n</code></pre> <p>Enfin, Il faudra cr\u00e9er un dossier variables.tf qui vous permettra de rensigner diff\u00e9rentes variables pour que terraform puisse acc\u00e8der a Terraform </p> <p>Voici ces information : </p> <pre><code>\nvariable \"proxmox_api_url\" {\n    type = string \n}\n\n\n\nvariable \"proxmox_api_token_id\" {\n    type = string\n    sensitive = true \n}\n\nvariable \"proxmox_api_token_secret\" {\n    type = string \n    sensitive = true   \n}\n</code></pre>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/terraform/Conf.terraform/#le-dossier-module","title":"Le dossier module","text":"<p>Les modules sert a cr\u00e9er des main.tf et variable.tf pour chaque sorte de vm ( ex: un module pour cr\u00e9er des serveurs et un autre pour cr\u00e9er des postes client)</p> <p>Ensuite il y a le main.tf qu'on a vu ci-dessus qui lui va reprendre le main.tf du modules mais dans lequel on va pouvoir modifier des informations sans toucher au main.tf du module</p>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/terraform/Conf.terraform/#creation-de-variablestf","title":"Cr\u00e9ation de variables.tf","text":"<p>Dans ce fichier vous allez renseigner toutes les variables necessaire a votre configuration de votre vm </p> <p>Voici un exemple : </p> <pre><code>\nvariable \"proxmox_node\" {\n    type = string\n    default = \"Nom de votre noeud\"\n    sensitive = true\n}\n\nvariable \"vm_pool\" {\n type = string\n default = \"test\"\n description = \"pool de la vm\"\n}\n\nvariable \"vm_clone\" {\n type = string\n default = \"sdn-tmplt\"\n description = \"nom du modele\"\n}\nvariable \"vm_sockets\" {\n type = number\n default = 1\n description = \"nombre de socket\"\n}\nvariable \"vm_cores\" {\n type = number\n default = 2\n description = \"nombre de core\"\n}\nvariable \"vm_memory\" {\n type = number\n default = 2048\n description = \"RAM\"\n}\n\n\n\n\nvariable \"vm_name\" {\n type = string\n default = \"vm-test-anto-\"\n description = \"nom de la vm\"\n}\n\n\nvariable \"vm_ip\" {\n type = string\n default = \"Vos 3 premiers octets de votre plage ip \"\n description = \"ip de la vm\"\n}\n\nvariable \"vm_gw\" {\n type = string\n default = \"Votre gateway \"\n description = \"gw vm\"\n}\n\nvariable \"vm_dns\" {\n type = string\n default = \"Vos dns\"\n description = \"dns de la machine\"\n}\n\nvariable \"vm_domain\" {\n type = string\n default = \"cg72.fr\"\n description = \"nom dns de la machine\"\n}\n\n\nvariable \"pubkeys\" {\n type = string\n default =  &lt;&lt;EOF\n\nVotre Clef pub \n}\n\n</code></pre>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/terraform/Conf.terraform/#notes","title":"Notes","text":"<p>Pour la variable Ip il y a que 3 octets car il y a le count.index qui va lui attribu\u00e9 le dernier selon la valeurs qu'on a renseign\u00e9 apr\u00e8s le +. Cela est utile quand vous allez cr\u00e9er plusieurs vm </p>"},{"location":"Stage_2024_CD72/Documentation/automatisation_vm/terraform/Conf.terraform/#le-fichier-maintf","title":"Le fichier main.tf","text":"<p>Ce fichier va vous permettre de configurer les bases de votre vm </p> <p>Voici un exemple : </p> <pre><code>\n\nterraform {\n  required_providers {\n    proxmox = {\n      source  = \"TheGameProfi/proxmox\"\n      version = \"2.9.16\"\n    }\n  }\n}\n\nresource \"proxmox_vm_qemu\" \"vm-multi\" {\n\n\n\n  target_node = \"${var.proxmox_node}\"\n\n  clone      = \"${var.vm_clone}\"\n  pool       = \"${var.vm_pool}\"\n  name       = \"${var.vm_name}\"\n  vmid = \"200\"\n\n  sockets    = \"${var.vm_sockets}\"\n  cores      = \"${var.vm_cores}\"\n  memory     = \"${var.vm_memory}\"\n\n  cipassword   = \"root\"\n\n  agent      = 1\n  os_type    = \"cloud-init\"\n\n  ipconfig0    = \"ip=${var.vm_ip}/16,gw=${var.vm_gw}\"\n  nameserver = \"${var.vm_dns}\"\n  searchdomain = \"${var.vm_domain}\"\n\n\n}\n\n</code></pre>"},{"location":"Veille%20techno/Ma%20veille/","title":"Une veille c'est quoi ?","text":"<p>Une veille c'est s'informer r\u00e9guli\u00e8rement pour ne rien manquer sur le sujet. Mon sujet est l'informatique. J'effectue ma veille \u00e0 chaque fin de semaine.</p>"},{"location":"Veille%20techno/Ma%20veille/#quel-outil-pour-effectuer-ma-veille","title":"Quel outil pour effectuer ma veille","text":"<p>J'utilise un flux RSS avec l'aide de google. J'ai pr\u00e9d\u00e9fini les th\u00e8mes des article et chaque matin, je re\u00e7ois des mails pour me pr\u00e9venir des articles qui sort chaques jours.</p>"},{"location":"Veille%20techno/Ma%20veille/#theme-de-ma-veille","title":"Th\u00e8me de ma veille","text":"<p>J'ai d\u00e9cider de travaille sur 3 th\u00e8mes : </p> <ul> <li>Le Cloud </li> <li>Les I.A</li> <li>VPN </li> </ul> <p>Pour acc\u00e9der \u00e0 ma veille technologique Cliquez ici</p>"}]}